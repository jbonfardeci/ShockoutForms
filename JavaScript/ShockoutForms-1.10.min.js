"use strict";var Shockout;!function(y){var e=function(){function l(e,t,o){void 0===o&&(o=void 0),this.allowDelete=!1,this.allowPrint=!0,this.allowSave=!1,this.allowedExtensions=["txt","rtf","zip","pdf","doc","docx","jpg","gif","png","ppt","tif","pptx","csv","pub","msg","xls","xlsx"],this.attachmentMessage="An attachment is required.",this.confirmationUrl="/SitePages/Confirmation.aspx",this.debug=!1,this.dialogOpts={width:400,height:250,autoOpen:!1,show:{effect:"blind",duration:1e3},hide:{effect:"explode",duration:1e3}},this.editableFields=[],this.enableAttachments=!1,this.enableErrorLog=!0,this.errorLogListName="Error Log",this.errorLogSiteUrl="/",this.fieldNames=[],this.includeUserProfiles=!0,this.includeWorkflowHistory=!0,this.includeNavigationMenu=!0,this.requireAttachments=!1,this.searchPrincipals=!0,this.siteUrl="",this.utils=y.Utils,this.viewModelIsBound=!1,this.workflowHistoryListName="Workflow History",this.currentUser={id:null,title:null,login:null,email:null,account:null,jobtitle:null,department:null,isAdmin:!1,groups:[]},this.itemId=null,this.listId=null,this.listItem=null,this.requireCheckout=!1,this.rootUrl=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),this.sourceUrl=null,this.version="1.0.1",this.queryStringId="formid",this.isSp2013=!1;var i,n=this;if(!(this instanceof l))throw i="You must declare an instance of this class with `new`.",alert(i),i;if(!t||!e){var a=["Missing required parameters:"];throw this.formId||a.push(" `formId`"),this.listName||a.push(" `listName`"),a=a.join(""),alert(a),a}if(this.formId=t,this.listName=e,this.listNameRest=y.Utils.toCamelCase(e),this.form="string"==typeof t?document.getElementById(t):t,this.form){if(this.$form=$(this.form).addClass("sp-form"),$("form").attr({novalidate:"novalidate"}),this.sourceUrl=y.Utils.getQueryParam("source"),this.sourceUrl&&(this.sourceUrl=decodeURIComponent(this.sourceUrl)),o&&o.constructor===Object)for(var r in o)this[r]=o[r];l.DEBUG=this.debug,l.searchPrincipals=this.searchPrincipals,this.itemId=y.Utils.getIdFromHash();var s=y.Utils.getQueryParam(this.queryStringId)||y.Utils.getQueryParam("ID");!this.itemId&&/\d/.test(s)&&(this.itemId=parseInt(s),y.Utils.setIdHash(this.itemId)),l.errorLogListName=this.errorLogListName,l.errorLogSiteUrl=this.errorLogSiteUrl,l.enableErrorLog=this.enableErrorLog,y.KoHandlers.bindKoHandlers(),this.viewModel=new y.ViewModel(this),this.viewModel.showUserProfiles(this.includeUserProfiles),n.$formStatus=$("<div>",{class:"form-status"}).appendTo(n.$form),n.$dialog=$("<div>",{id:"formdialog"}).appendTo(n.$form).dialog(n.dialogOpts),this.asyncFns=[n.getCurrentUserAsync,n.getUsersGroupsAsync,function(e){e.preRender&&e.preRender(e,e.viewModel),e.nextAsync(!0)},n.getListAsync,n.initForm,function(e,t){void 0===t&&(t=void 0),y.KoComponents.registerKoComponents(),ko.applyBindings(e.viewModel,e.form),e.viewModelIsBound=!0,e.nextAsync(!0)},n.getListItemAsync,n.getHistoryAsync,function(e){e.postRender&&e.postRender(e,e.viewModel),e.nextAsync(!0)},n.implementPermissions,n.finalize],this.nextAsync(!0,"Begin initialization...")}else alert('An element with the ID "'+this.formId+'" was not found. Ensure the `formId` parameter in the constructor matches the ID attribute of the form element.')}return l.prototype.getCurrentUser=function(){return this.currentUser},l.prototype.getDefaultViewUrl=function(){return this.defaultViewUrl},l.prototype.getDefailtMobileViewUrl=function(){return this.defaultMobileViewUrl},l.prototype.getForm=function(){return this.form},l.prototype.getItemId=function(){return this.itemId},l.prototype.setItemId=function(e){this.itemId=e},l.prototype.getListId=function(){return this.listId},l.prototype.getListItem=function(){return this.listItem},l.prototype.requiresCheckout=function(){return this.requireCheckout},l.prototype.getRootUrl=function(){return this.rootUrl},l.prototype.getSourceUrl=function(){return this.sourceUrl},l.prototype.getViewModel=function(){return this.viewModel},l.prototype.getVersion=function(){return this.version},l.prototype.nextAsync=function(e,t,o){void 0===e&&(e=!0),void 0===t&&(t=void 0),void 0===o&&(o=void 0);var i=this;t&&this.updateStatus(t,e,i),e&&(0!=this.asyncFns.length?this.asyncFns.shift()(i,o):setTimeout(function(){i.$formStatus.hide()},2e3))},l.prototype.getCurrentUserAsync=function(o,e){void 0===e&&(e=void 0),o.updateStatus("Retrieving your account...",!0,o);var i="Retrieved your account.";o.debug&&console.info("Testing for SP 2013 API..."),y.SpApi15.getCurrentUser(function(e,t){404==t?y.SpSoap.getCurrentUser(function(e,t){t?o.nextAsync(!1,"Failed to retrieve your account. "+t):(o.currentUser=e,o.viewModel.currentUser(e),o.debug&&(console.info("This is SP 2010 REST services."),console.info("Current user is..."),console.info(o.viewModel.currentUser())),o.nextAsync(!0,i))}):(o.isSp2013=!0,o.currentUser=e,o.viewModel.currentUser(e),o.debug&&(console.info("This is the SP 2013 API."),console.info("Current user is..."),console.info(o.viewModel.currentUser())),o.nextAsync(!0,i))},!0,o.siteUrl)},l.prototype.getListAsync=function(g,e){void 0===e&&(e=void 0);var x=/choice/i,s=/\b(FolderChildCount|ItemChildCount|MetaInfo|ContentType|Edit|Type|LinkTitleNoMenu|LinkTitle|LinkTitle2|Version|Attachments)\b/;function l(e,t){if(t)try{var i,o=$(t),n=o.attr("DisplayName"),a=o.attr("Type"),r=o.attr("Name"),s=o.attr("Format"),l=!!o.attr("Required")&&"true"==o.attr("Required").toLowerCase(),d=!!o.attr("ReadOnly")&&"true"==o.attr("ReadOnly").toLowerCase(),c=o.attr("Description"),u=g.viewModel,p=y.Utils.toCamelCase(n);if(p in g.viewModel)return;g.fieldNames.push(p),o.find("> Default").each(function(e,t){var o=$.trim($(t).text());if(a)switch(a.toLowerCase()){case"boolean":o="0"!=o;break;case"number":case"currency":o-=0;break;case"datetime":"[today]"==o&&(o=new Date)}i=o});var m=a&&/^multi/i.test(a)?ko.observableArray([]):ko.observable(i||"Boolean"!=a&&null);for(var f in m._metadata={koName:p,displayName:n||null,name:r||null,format:s||null,required:l||!1,readOnly:d||!1,description:c||null,type:a},m._metadata)m["_"+f]=m._metadata[f];if(x.test(a)){var h=o.attr("FillInChoice");m._isFillInChoice=!!h&&"True"==h;var v=[],b=[];o.find("CHOICE").each(function(e,t){var o=$(t).text();v.push({value:$(t).text(),selected:!1}),b.push(o)}),m._choices=v,m._options=b,m._multiChoice=!!a&&"MultiChoice"==a,m._metadata.choices=v,m._metadata.options=b,m._metadata.multichoice=m._multiChoice}m._metadata.$parent=m,u[p]=m,g.debug&&console.info("Created KO object: "+p+", type: "+a+", default val: "+i)}catch(e){if(g.logError("Failed to setup KO object at SPForm.getListAsync.setupKoVar(): ",e),g.debug)throw e}}y.SpSoap.getList(g.siteUrl,g.listName,function(e,t){if(t){var o="Failed to retrieve list data. "+t;return g.nextAsync(!1,"Failed to retrieve list data. "+t),void g.logError(o)}!function(e){try{var t=$(e).find("List").first(),o=t.attr("ID");g.listId=o;var i=t.attr("RequireCheckout");g.requireCheckout=!!i&&"true"==i.toLowerCase();var n=t.attr("EnableAttachments");g.enableAttachments=!!n&&"true"==n.toLowerCase(),g.defaultViewUrl=t.attr("DefaultViewUrl"),g.defaultMobileViewUrl=t.attr("MobileDefaultViewUrl");var a=t.attr("RootFolder");g.listItemType=y.Utils.tail(a.split("/")).toString(),$(e).find("Field").filter(function(e,t){return!!$(t).attr("DisplayName")&&"TRUE"!=$(t).attr("Hidden")&&!s.test($(t).attr("Name"))}).each(l),g.fieldNames.sort(),g.debug&&(console.info(g.listName+" list ID = "+g.listId),console.info("Field names are..."),console.info(g.fieldNames)),g.nextAsync(!0,"Initialized list settings.")}catch(e){if(g.debug)throw e;var r="Failed to initialize list settings.";g.logError(r+" SPForm.getListAsync.setupList(): ",e),g.nextAsync(!1,r)}}(e)})},l.prototype.initForm=function(o,e){void 0===e&&(e=void 0);try{o.updateStatus("Initializing dynamic form features...",!0,o);o.viewModel;if(-1<y.Utils.indexOf(o.fieldNames,"IsSubmitted")&&(o.allowSave=!0,y.ViewModel.isSubmittedKey="IsSubmitted",o.debug&&console.info("initFormAsync: IsSubmitted key: "+y.ViewModel.isSubmittedKey)),o.viewModel.allowSave(o.allowSave),o.viewModel.allowPrint(o.allowPrint),o.viewModel.allowDelete(o.allowDelete),o.$formAction=$(y.Templates.getFormAction()).appendTo(o.$form),o.enableAttachments&&o.setupAttachments(o),o.enableErrorLog&&y.SpApi.getListItems(o.errorLogListName,function(e,t){t&&(o.enableErrorLog=l.enableErrorLog=!1)},o.errorLogSiteUrl,null,"Title,Error","Modified",1,!1),o.includeNavigationMenu){var t=o.$form.find(".so-nav-menu, [data-so-nav-menu], [so-nav-menu]");0<t.length?t.replaceWith(y.Templates.soNavMenuControl):o.$form.prepend(y.Templates.soNavMenuControl)}if(o.$form.find(".created-info, [data-sp-created-info], [data-so-created-info], [sp-created-info], [so-created-info]").replaceWith(y.Templates.soCreatedModifiedInfoControl),o.includeWorkflowHistory){var i=o.$form.find(".workflow-history, [data-so-workflow-history], [so-workflow-history]");0<i.length?i.replaceWith(y.Templates.soWorkflowHistoryControl):o.$form.append(y.Templates.soWorkflowHistoryControl)}return o.$form.find("[data-new-only]").before("\x3c!-- ko ifnot: !!$root.Id() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-edit-only]").before("\x3c!-- ko if: !!$root.Id() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-author-only]").before("\x3c!-- ko if: !!$root.isAuthor() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-non-authors]").before("\x3c!-- ko ifnot: !!$root.isAuthor() --\x3e").after("\x3c!-- /ko --\x3e"),void o.nextAsync(!0,"Form initialized.")}catch(e){if(o.debug)throw e;return o.logError("Error in SPForm.initFormAsync(): ",e),void o.nextAsync(!1,"Failed to initialize form.")}},l.prototype.getListItemAsync=function(o,e){if(void 0===e&&(e=void 0),o.itemId){o.updateStatus("Retrieving form values...",!0,o);o.viewModel;var t=[];o.enableAttachments&&t.push("Attachments"),y.SpApi.getListItem(o.listName,o.itemId,function(e,t){if(t)return/not found/i.test(t+"")&&o.showDialog("The form with ID "+o.itemId+" doesn't exist or it was deleted."),void o.nextAsync(!1,t);o.listItem=e,o.bindListItemValues(o),o.nextAsync(!0,"Retrieved form data.")},o.siteUrl,!1,0<t.length?t.join(","):null)}else o.nextAsync(!0,"This is a New form.")},l.prototype.getUsersGroupsAsync=function(o,e){void 0===e&&(e=void 0),o.isSp2013?o.nextAsync(!0):(o.updateStatus("Retrieving your groups...",!0,o),y.SpSoap.getUsersGroups(o.currentUser.login,function(e,t){t?o.nextAsync(!1,"Failed to retrieve your groups. "+t):(o.currentUser.groups=e,o.debug&&(console.info("Retrieved current user's groups..."),console.info(o.currentUser.groups)),o.nextAsync(!0,"Retrieved your groups."))},o.siteUrl))},l.prototype.implementPermissions=function(t,e){void 0===e&&(e=void 0);try{t.updateStatus("Retrieving your permissions...",!0,t),t.$form.find("[data-sp-groups], [user-groups]").each(function(e,t){var o=$(t).attr("data-sp-groups");o||(o=$(t).attr("user-groups")),$(t).before("\x3c!-- ko if: !!$root.isMember("+o+") --\x3e").after("\x3c!-- /ko --\x3e")}),t.nextAsync(!0,"Retrieved your permissions.")}catch(e){if(t.debug)throw e;t.logError("Error in SPForm.implementPermissionsAsync() ",e),t.nextAsync(!0,"Failed to retrieve your permissions.")}},l.prototype.getHistoryAsync=function(n,e){if(void 0===e&&(e=void 0),n.itemId&&n.includeWorkflowHistory){n.updateStatus("Retrieving workflow history...",!0,n);var t="ListID eq '"+n.listId+"' and PrimaryItemID eq "+n.itemId;y.SpApi.getListItems(n.workflowHistoryListName,function(e,t){n.debug&&(console.info("Retrieved workflow history..."),console.info(e.length));if(t||!e){var o="The "+n.workflowHistoryListName+' list may be full at <a href="{url}">{url}</a>. Failed to retrieve workflow history in method, getHistoryAsync().'.replace(/\{url\}/g,n.rootUrl+n.siteUrl+"/Lists/"+n.workflowHistoryListName.replace(/\s/g,"%20"));return n.logError(o),void n.nextAsync(!1,"Failed to retrieve workflow history. "+t)}n.viewModel.historyItems([]);for(var i=0;i<e.length;i++)n.viewModel.historyItems().push(new y.HistoryItem(e[i].Description,y.Utils.parseDate(e[i].DateOccurred)));n.viewModel.historyItems.valueHasMutated(),n.nextAsync(!0,"Retrieved workflow history.")},n.siteUrl,t,"Description,DateOccurred","DateOccurred",25,!1)}else n.nextAsync(!0)},l.prototype.bindListItemValues=function(a){void 0===a&&(a=void 0),a=a||this;try{if(!a.itemId)return;var o=a.listItem,r=a.viewModel,e=/\b(__metadata|ContentTypeID|ContentType|Owshiddenversion|Version|Attachments|Path)\b/,t=/(MultiChoice|User|Choice)/;for(var i in a.itemId=o.Id,r.Id(o.Id),a.viewModel)i in o&&"_type"in r[i]&&!e.test(i)&&!t.test(r[i]._type)&&(null!=o[i]&&"DateTime"==r[i]._type?r[i](y.Utils.parseDate(o[i])):"MultiChoice"==r[i]._type&&"results"in o[i]?r[i](o[i].results):r[i](o[i]||null));a.enableAttachments&&(a.viewModel.attachments(o.Attachments.results),a.viewModel.attachments.valueHasMutated());var n=o.CreatedBy,s=o.ModifiedBy;n&&s&&(o.CreatedBy.Picture=y.Utils.formatPictureUrl(o.CreatedBy.Picture),o.ModifiedBy.Picture=y.Utils.formatPictureUrl(o.ModifiedBy.Picture),o.CreatedBy.WorkEMail=o.CreatedBy.WorkEMail||o.CreatedBy.EMail||"",o.ModifiedBy.WorkEMail=o.ModifiedBy.WorkEMail||o.ModifiedBy.EMail||"",o.CreatedBy.JobTitle=o.CreatedBy.JobTitle||o.CreatedBy.Title||null,o.ModifiedBy.JobTitle=o.ModifiedBy.JobTitle||o.ModifiedBy.Title||null,o.CreatedBy.WorkPhone=o.CreatedBy.WorkPhone||n.MobileNumber||null,o.ModifiedBy.WorkPhone=o.ModifiedBy.WorkPhone||s.MobileNumber||null,o.CreatedBy.Office=o.CreatedBy.Office||null,o.ModifiedBy.Office=o.ModifiedBy.Office||null,r.CreatedBy(o.CreatedBy),r.ModifiedBy(o.ModifiedBy)),r.Created(y.Utils.parseDate(o.Created)),r.Modified(y.Utils.parseDate(o.Modified)),$(a.fieldNames).filter(function(e,t){return!!a.viewModel[t]&&("User"==a.viewModel[t]._type&&t+"Id"in o)}).each(function(e,t){a.getPersonById(parseInt(o[t+"Id"]),r[t])}),$(a.fieldNames).filter(function(e,t){return!!a.viewModel[t]&&("Choice"==a.viewModel[t]._type&&t+"Value"in o)}).each(function(e,t){r[t](o[t+"Value"])}),$(a.fieldNames).filter(function(e,t){return!!a.viewModel[t]&&"MultiChoice"==a.viewModel[t]._type&&"__deferred"in o[t]}).each(function(e,n){y.SpApi.executeRestRequest(o[n].__deferred.uri,function(e,t,o){a.debug&&(console.info("Retrieved MultiChoice data for "+n+"..."),console.info(e));var i=[];$.each(e.d.results,function(e,t){i.push(t.Value)}),r[n](i)})}),$(a.fieldNames).filter(function(e,t){return!!a.viewModel[t]&&"UserMulti"==a.viewModel[t]._type&&"__deferred"in o[t]}).each(function(e,n){y.SpApi.executeRestRequest(o[n].__deferred.uri,function(e,t,o){var i=[];$.each(e.d.results,function(e,t){i.push(t.Id+";#"+t.Account)}),r[n](i)})})}catch(e){if(a.debug)throw e;a.logError("Failed to bind form values in SPForm.bindListItemValues(): ",e)}},l.prototype.deleteListItem=function(e,o,i){if(void 0===o&&(o=void 0),void 0===i&&(i=3e3),confirm("Are you sure you want to delete this form?")){var n=e.parent,t=n.listItem;y.SpApi.deleteListItem(t,function(e,t){t?o&&o(e,t):(n.showDialog("The form was deleted. You'll be redirected in "+i/1e3+" seconds."),o&&o(e),setTimeout(function(){window.location.replace(null!=n.sourceUrl?n.sourceUrl:n.rootUrl)},i))})}},l.prototype.saveListItem=function(r,e,t,o){void 0===e&&(e=!1),void 0===t&&(t=void 0),void 0===o&&(o=void 0);var a=r.parent,i=!(null!=a.itemId),n=3e3,s=t||"<p>Your form has been saved.</p>",l=[],d={};try{var c=y.Utils.getEditableKoNames(a.$form);if($(c).each(function(e,t){a.pushEditableFieldName(t)}),a.editableFields.sort(),a.debug&&(console.info("Editable fields..."),console.info(a.editableFields)),e=void 0===e||e,a.preSave){var u=a.preSave(a,a.viewModel,e);if(void 0!==u&&!u)return}if(e&&!a.formIsValid(r))return;var p=r[y.ViewModel.isSubmittedKey];void 0===p||null!=p()&&0!=p()||(l.push([y.ViewModel.isSubmittedKey,e?1:0]),d[y.ViewModel.isSubmittedKey]=e);var m=$(a.editableFields);a.isSp2013?(m.each(function(e,t){if("_metadata"in r[t]){var o=r[t](),i=r[t]._name,n=r[t]._type||r[t]._metadata.type;if(n=n?n.toLowerCase():null,void 0!==o&&t!=y.ViewModel.isSubmittedKey){if("datetime"==n){var a=y.Utils.parseDate(o);a&&(o=a)}else null!=o&&"note"==n&&(o=$("<div>").html(o).html());d[i]=o}}}),y.SpApi15.SaveListItem(a.siteUrl,a.listName,a.listItemType,d,a.itemId).then(function(e){a.itemId=e.Id,r.Id(a.itemId),f()})):(m.each(function(e,t){if("_metadata"in r[t]){var o=r[t](),i=r[t]._name,n=r[t]._type||r[t]._metadata.type;if(n=n?n.toLowerCase():null,void 0!==o&&t!=y.ViewModel.isSubmittedKey){if(null!=o&&o.constructor===Array)0<o.length&&(o=o.join(";#")+";#");else if("datetime"==n){var a=y.Utils.parseDate(o);a&&(o=a.toISOString())}else null!=o&&"note"==n&&(o="<![CDATA["+$("<div>").html(o).html()+"]]>");o=null==o?"":o,l.push([i,o])}}}),y.SpSoap.updateListItem(a.itemId,a.listName,l,i,a.siteUrl,function(e,t,o){var i;a.debug&&(console.log("Callback from saveListItem()..."),console.log(t),console.log(e));var n=$(e).find("ErrorText");if(n&&""!=n.text())return void a.logError(n.text());$(e).find("*").filter(function(){return y.Utils.isZrow(this)}).each(function(e,t){i=parseInt($(t).attr("ows_ID")),a.itemId=i,r.Id(i),a.debug&&(console.info("Item ID returned..."),console.info(i))}),f()}))}catch(e){if(a.debug)throw e;a.logError("Error in SpForm.saveListItem(): ",e)}function f(){null==y.Utils.getIdFromHash()&&null!=a.itemId&&y.Utils.setIdHash(a.itemId),e?(a.showDialog("<p>Your form has been submitted. You will be redirected in "+n/1e3+" seconds.</p>","Form Submission Successful"),o&&o(a.itemId),a.debug?console.warn("DEBUG MODE: Would normally redirect user to confirmation page: "+a.confirmationUrl):setTimeout(function(){window.location.href=null!=a.sourceUrl?a.sourceUrl:a.confirmationUrl},n)):(a.showDialog(s,"The form has been saved.",n),a.getListItemAsync(a),o&&o(a.itemId),a.includeWorkflowHistory&&setTimeout(function(){a.getHistoryAsync(a)},5e3))}},l.prototype.finalize=function(t){try{t.setupNavigation(t),t.setupDatePickers(t),t.nextAsync(!0,"Finalized form controls.")}catch(e){if(t.debug)throw e;t.logError("Error in SpForm.finalize(): ",e),t.nextAsync(!1,"Failed to finalize form controls.")}},l.prototype.deleteAttachment=function(o,e){if(confirm("Are you sure you want to delete "+o.Name+"? This can't be undone.")){var i=y.ViewModel.parent.viewModel;y.SpApi.deleteAttachment(o,function(e,t){t?alert("Failed to delete attachment: "+t):i.attachments.remove(o)})}},l.prototype.getAttachments=function(i,n){if(void 0===i&&(i=void 0),void 0===n&&(n=void 0),(i=i||this).listItem&&i.enableAttachments){var a=[];y.SpApi.executeRestRequest(i.listItem.__metadata.uri+"/Attachments",function(e,t,o){try{i.viewModel.attachments(e.d.results),i.viewModel.attachments.valueHasMutated(),n&&n(a)}catch(e){if(i.debug)throw e;i.showDialog("Failed to retrieve attachments in SpForm.getAttachments(): ",e)}})}else n&&n()},l.prototype.log=function(e){this.debug&&console.log(e)},l.prototype.updateStatus=function(e,t,o){void 0===t&&(t=!0);var i=o;i.$formStatus.html(e).css("color",t?"#ff0":"$f00").show(),setTimeout(function(){i.$formStatus.hide()},2e3)},l.prototype.showDialog=function(e,t,o){void 0===t&&(t=void 0),void 0===o&&(o=void 0);var i=this;t=t||"Form Dialog",e=null==e.toString().match(/<\w>\w*/)?"<p>"+e+"</p>":e,i.$dialog.html(e).dialog("open"),o&&setTimeout(function(){i.$dialog.dialog("close")},o)},l.prototype.formIsValid=function(r,e){void 0===e&&(e=!1);var s=r.parent,l=[],d=0,o=0,i=[];try{return s.$form.find(".required, [required]").each(function(e,t){var o=y.Utils.observableNameFromControl(t,s.viewModel);if(o&&r[o]){var i=r[o]();if(null==i||0==$.trim(i+"").length){var n,a=$("label[for='"+o+"']");a&&(n=a.html()),n||(n=$(t).closest(".form-group").find("label:first").html()),n||(n=r[o]._displayName),n||$(t).parent().first().html(),y.Utils.indexOf(l,n)<0&&(l.push(n),d++)}}}),s.$form.find(".invalid").each(function(e,t){$(t).parent();i.push($(parent).first().html()),o++}),0<o&&l.push('<p class="warning">There are validation errors with the following fields. Please correct before saving.</p><p style="color:#f00;">'+i.join("<br />")+"</p>"),s.enableAttachments&&s.requireAttachments&&0==r.attachments().length&&(d++,l.push(s.attachmentMessage)),!(0<d)||(s.showDialog('<p>The following fields are required or invalid:</p><div class="error">'+l.join("<br/>")+"</div>"),!1)}catch(e){if(s.debug)throw e;return s.logError("Form validation error at SPForm.formIsValid(): ",e),!1}},l.prototype.getPersonById=function(e,n){var a=this;e&&y.SpApi.getPersonById(e,function(e,t){if(t){var o="Error in SPForm.getPersonById: "+t;return y.Utils.logError(o,l.errorLogListName),void(a.debug&&console.warn(o))}var i=e.Id+";#"+e.Name.replace(/^i\:0\#\.w\|/,"");n(i),a.debug&&console.warn("Retrieved person by ID... "+i)})},l.prototype.pushEditableFieldName=function(e){return!e||-1<y.Utils.indexOf(this.editableFields,e)||null!=e.match(/^(_|\$)/)||y.Utils.indexOf(this.fieldNames,e)<0||this.viewModel[e]._readOnly?-1:this.editableFields.push(e)},l.prototype.logError=function(e,t,o){void 0===t&&(t=void 0),void 0===o&&(o=void 0),o=o||this;var i=[e];t&&i.push(t+""),i=0<i.length?i.join("; "):i.join(""),o.enableErrorLog&&(y.Utils.logError(i,o.errorLogListName,o.errorLogSiteUrl,o.debug),o.showDialog("<p>An error has occurred and the web administrator has been notified.</p><pre>"+i+"</pre>"))},l.prototype.setupAttachments=function(t){void 0===t&&(t=void 0);(t=t||this).viewModel;if(!t.enableAttachments)return 0;try{t.$form.find(".attachments, [data-sp-attachments]").each(function(e,t){$(t).replaceWith('<so-attachments params="val: attachments"></so-attachments>')}),t.debug&&console.info("Attachments are enabled.")}catch(e){if(t.debug)throw e;t.logError("Error in SPForm.setupAttachments(): ",e)}return 0},l.prototype.setupNavigation=function(r){void 0===r&&(r=void 0);var s=0;if(!(r=r||this).includeNavigationMenu)return s;try{if(0==r.$form.find(".nav-section").length)return s;r.$form.find(".nav-section:visible").each(function(e,t){var o=$(t),i=o.find("> h4");if(0!=i.length){var n=i.html(),a=y.Utils.toCamelCase(n)+"Nav";o.before('<div style="height:1px;" id="'+a+'">&nbsp;</div>'),r.viewModel.navMenuItems().push({title:n,anchorName:a}),s++}}),r.viewModel.navMenuItems.valueHasMutated(),r.$form.append('<a href="#TOP" class="back-to-top"><span class="glyphicon glyphicon-chevron-up"></span></a>'),$("body").delegate("a[href*=#]:not([href=#])","click",function(){if(window.location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if((e=e.length?e:$("[name="+this.hash.slice(1)+"]")).length)return $("html,body").animate({scrollTop:e.offset().top-50},1e3),!1}})}catch(e){if(r.debug)throw e;r.logError("Error in SpForm.setupNavigation(): ",e)}return s},l.prototype.setupDatePickers=function(e){void 0===e&&(e=void 0);var t=(e=e||this).$form.find("input.datepicker").datepicker();return e.debug&&console.info("Bound "+t.length+" jQueryUI datepickers."),t.length},l.prototype.currentUserIsMemberOfGroups=function(e){var t=[];if(y.Utils.isString(e))t=null!=e.match(/\,/)?e.split(","):[e];else{if(e.constructor!==Array)return!1;t=e}for(var o=0;o<t.length;o++){var i=t[o];i=null!=i.match(/\;#/)?i.split(";")[0]:i,i=y.Utils.trim(i);for(var n=0;n<this.currentUser.groups.length;n++){var a=this.currentUser.groups[n];if(i==a.name||parseInt(i)==a.id)return!0}}return!1},l.DEBUG=!1,l}();y.SPForm=e}(Shockout||(Shockout={})),window.so=window.so||Shockout,function(e){var t=function(){function o(e){this.Id=ko.observable(null),this.Created=ko.observable(null),this.CreatedBy=ko.observable(null),this.Modified=ko.observable(null),this.ModifiedBy=ko.observable(null),this.allowSave=ko.observable(!1),this.allowPrint=ko.observable(!1),this.allowDelete=ko.observable(!1),this.attachments=ko.observableArray(),this.historyItems=ko.observableArray(),this.showUserProfiles=ko.observable(!1),this.navMenuItems=ko.observableArray();var t=this;this.parent=e,o.parent=e,this.isValid=ko.pureComputed(function(){return t.parent.formIsValid(t)}),this.deleteAttachment=e.deleteAttachment,this.currentUser=ko.observable(e.getCurrentUser()),this.attachments.getViewModel=function(){return t},this.attachments.getSpForm=function(){return t.parent},this.isMember=ko.pureComputed({read:function(){return!1},write:function(e){return t.parent.currentUserIsMemberOfGroups(e)},owner:this})}return o.prototype.isAuthor=function(){return!this.CreatedBy()||this.currentUser().id==this.CreatedBy().Id},o.prototype.deleteItem=function(){this.parent.deleteListItem(this)},o.prototype.cancel=function(){var e=this.parent.getSourceUrl();window.location.href=e||this.parent.getRootUrl()},o.prototype.print=function(){window.print()},o.prototype.save=function(e,t){this.parent.saveListItem(e,!1)},o.prototype.submit=function(e,t){this.parent.saveListItem(e,!0)},o}();e.ViewModel=t}(Shockout||(Shockout={})),function(p){var e=function(){function e(){}return e.bindKoHandlers=function(){var u;(u=ko).bindingHandlers.spHtmlEditor={init:function(e,t,o,i){var n=p.Utils.observableNameFromControl(e);function a(){i[n]($(this).html())}$(e).blur(a).change(a).keydown(a)},update:function(e,t,o,i){var n=u.utils.unwrapObservable(t())||"";e.innerHTML!==n&&(e.innerHTML=n)}},u.bindingHandlers.spPerson={init:function(e,t,o,i){try{if("input"!=e.tagName.toLowerCase()||"hidden"==$(e).attr("type"))return;i.$data;var n=t(),a=(u.unwrap(n),$(e).addClass("people-picker-control").attr("placeholder","Employee Account Name")),r=($(e).parent(),$("<div>",{class:"sp-validation person"}));a.after(r);var s=$("<div>",{class:"no-print",html:"<em>Enter the employee name. The auto-suggest menu will appear below the field. Select the account name.</em>"});r.after(s);var l=$("<button>",{html:p.Templates.personIcon,class:p.Templates.buttonDefault,title:"Validate the employee account name."}).on("click",function(){return""==$.trim(a.val())?a.removeClass("invalid").removeClass("valid"):p.Utils.validateSpPerson(n())?(r.text("Valid").removeClass("error"),a.removeClass("invalid").addClass("valid").show()):(r.text("Invalid").addClass("error").show(),a.addClass("invalid").removeClass("valid")),!1}).insertAfter(a),d=($("<button>",{class:p.Templates.resetButton,html:"Reset"}).on("click",function(){return n(null),!1}).insertAfter(l),{source:p.SPForm.searchPrincipals?function(e,o){p.SpSoap.searchPrincipals(e.term,function(e){var t=$.map(e,function(e){var t=e.AccountName;return-1<t.indexOf("|")&&(t=t.split("|")[1]),{label:e.DisplayName+" ("+e.Email+")",value:e.UserInfoID+";#"+t}});$.isFunction(p.peopleFilter)&&(t=p.peopleFilter(t)),o(t)},10,"User")}:function(e,a){p.SpApi.searchUsers(e.term,function(e){for(var t=[],o=0;o<e.length;o++){var i=e[o],n=i.Account;-1<n.indexOf("|")&&(n=n.split("|")[1]),t.push({label:i.Name+" ("+i.WorkEmail+")",value:i.Id+";#"+n})}$.isFunction(p.peopleFilter)&&(t=p.peopleFilter(t)),a(t)})},minLength:3,select:function(e,t){n(t.item.value)}});$(e).autocomplete(d),$(e).on("focus",function(){$(this).removeClass("valid")}).on("blur",function(){c(this,n)}).on("mouseout",function(){c(this,n)})}catch(e){p.SPForm.DEBUG&&(console.info("Error in Knockout handler spPerson init()"),console.info(e))}function c(e,t){var o=$.trim($(e).val());if(""==o)return t(null),void $(e).removeClass("valid").removeClass("invalid");p.Utils.validateSpPerson(t())?($(e).val(t().split("#")[1]),$(e).addClass("valid").removeClass("invalid")):$(e).removeClass("valid").addClass("invalid")}},update:function(e,t,o,i){try{i.$data;var n=t(),a=u.unwrap(n),r="";p.Utils.validateSpPerson(a)&&(r=-1<a.indexOf("|")?a.split("|")[1]:a.split("#")[1],$(e).addClass("valid")),"value"in e?$(e).val(r):$(e).text(r)}catch(e){p.SPForm.DEBUG&&(console.info("Error in Knockout handler spPerson update()"),console.info(e))}}},u.bindingHandlers.spMoney={init:function(e,t,o,i,n){if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){n.$data;var a=t();u.unwrap(a),$(e).on("blur",r).on("change",r)}function r(){var e=this.value.toString().replace(/[^\d\.\-]/g,"");a(e=""==e?null:e-0)}},update:function(e,t,o,i,n){n.$data;var a=t(),r=u.unwrap(a);null!=r?r<0?$(e).addClass("negative"):$(e).removeClass("negative"):r=0;var s=p.Utils.formatMoney(r);p.Utils.updateKoField(e,s)}},u.bindingHandlers.spDecimal={init:function(e,t,o,i,n){if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){n.$data;var a=t();u.unwrap(a),$(e).on("blur",r).on("change",r)}function r(){var e=this.value.toString().replace(/[^\d\-\.]/g,"");a(e=""==e?null:e-0)}},update:function(e,t,o,i,n){n.$data;var a=t(),r=u.unwrap(a),s=o.get("precision")||2,l=p.Utils.toFixed(r,s);null!=r?r<0?$(e).addClass("negative"):$(e).removeClass("negative"):r=0,p.Utils.updateKoField(e,l)}},u.bindingHandlers.spNumber={init:function(e,t,o,i,n){if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){n.$data;var a=t();u.unwrap(a),$(e).on("blur",r).on("change",r)}function r(){var e=this.value.toString().replace(/[^\d\-]/g,"");a(e=""==e?null:e-0)}},update:function(e,t,o,i,n){n.$data;var a=t(),r=u.unwrap(a);r=(r=null==r?0:r).constructor==String?r=r.replace(/\D/g)-0:r,p.Utils.updateKoField(e,r),a.constructor==Function&&a(r)}},u.bindingHandlers.spDate={after:["attr"],init:function(e,t,o,i,n){var a=t();function r(){a(p.Utils.parseDate(this.value))}"input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")&&($(e).css("display","inline-block").addClass("datepicker med").attr("placeholder","MM/DD/YYYY").on("blur",r).on("change",r).after(p.Templates.calendarIcon),$(e).datepicker({changeMonth:!0,changeYear:!0}))},update:function(e,t,o,i,n){var a=t(),r=p.Utils.parseDate(u.unwrap(a)),s="";r&&null!=r&&(s=p.Utils.dateToLocaleString(r)),"value"in e?$(e).val(s):$(e).text(s)}},u.bindingHandlers.spDateTime={after:["attr"],init:function(e,t,o,i,n){if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type"))try{var a=t(),r=new p.DateTimeModel(e,a);e.$$model=r}catch(e){if(p.SPForm.DEBUG)throw console.warn("Error in Knockout handler spDateTime init()..."),e}},update:function(e,t,o,i,n){try{var a=t();if(p.Utils.parseDate(u.unwrap(a)),"input"==e.tagName.toLowerCase()){var r=e.$$model;r&&r.setDisplayValue(a)}else $(e).text(p.DateTimeModel.toString(a))}catch(e){if(p.SPForm.DEBUG)throw console.warn("Error in Knockout handler spDateTime update()..."),e}}}},e}();p.KoHandlers=e}(Shockout||(Shockout={})),function(p){var e=function(){function e(){}return e.registerKoComponents=function(){var e,r=(e=0,function(){return e++});function t(e){if(!e)throw"params is undefined in so-static-field";var t=e.val||e.modelValue;if(!t)throw"Parameter `val` or `modelValue` for so-static-field is required!";this.modelValue=t,this.id=e.id||t._koName,this.label=e.label||t._displayName,this.description=e.description||t._description;var o=parseInt(e.labelColWidth||3),i=parseInt(e.fieldColWidth||12-(o-0));this.labelColWidth="col-sm-"+o,this.fieldColWidth="col-sm-"+i}function o(e){if(!e)throw"params is undefined in soFieldModel";var t=e.val||e.modelValue;if(!t)throw"Parameter `val` or `modelValue` for so-text-field is required!";this.modelValue=t,this.id=e.id||t._koName,this.name=e.name||t._koName||e.id,this.label=e.label=""==e.label?void 0:e.label||t._displayName,this.title=e.title,this.caption=e.caption,this.maxlength=e.maxlength||255,this.placeholder=e.placeholder||e.label||t._displayName,this.description=void 0!==e.description?null==e.description?void 0:e.description:t._description,this.valueUpdate=e.valueUpdate,this.editable=!!t._koName,this.koName=t._koName,this.options=e.options||t._options,this.required="function"==typeof e.required?e.required:ko.observable(!!e.required||!1),this.inline=e.inline||!1,this.multiline=e.multiline||!1;var o=parseInt(e.labelColWidth||3),i=parseInt(e.fieldColWidth||12-(o-0));this.labelColWidth="col-sm-"+o,this.fieldColWidth="col-sm-"+i,this.readOnly="function"==typeof e.readOnly?e.readOnly:ko.observable(!!e.readOnly||!1)}ko.components.register("so-text-field",{viewModel:o,template:p.Templates.soTextField}),ko.components.register("so-html-field",{viewModel:o,template:p.Templates.soHtmlFieldTemplate}),ko.components.register("so-person-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spPerson: modelValue')}),ko.components.register("so-date-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDate: modelValue')}),ko.components.register("so-datetime-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDateTime: modelValue')}),ko.components.register("so-money-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spMoney: modelValue')}),ko.components.register("so-number-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spNumber: modelValue')}),ko.components.register("so-decimal-field",{viewModel:o,template:p.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDecimal: modelValue')}),ko.components.register("so-checkbox-field",{viewModel:o,template:p.Templates.soCheckboxField}),ko.components.register("so-select-field",{viewModel:o,template:p.Templates.soSelectField}),ko.components.register("so-checkbox-group",{viewModel:o,template:p.Templates.soCheckboxGroup}),ko.components.register("so-radio-group",{viewModel:o,template:p.Templates.soRadioGroup}),ko.components.register("so-usermulti-group",{viewModel:function(e){if(!e)throw"params is undefined in soFieldModel";var i=this,t=e.val||e.modelValue;if(!t)throw"Parameter `val` or `modelValue` for so-text-field is required!";this.modelValue=t,this.placeholder="",this.id=e.id||t._koName,this.name=e.name||t._koName||e.id,this.label=e.label||t._displayName,this.title=e.title,this.required=e.required,this.description=e.description||t._description,this.editable=!!t._koName,this.koName=t._koName,this.person=ko.observable(null),this.readOnly="function"==typeof e.readOnly?e.readOnly:ko.observable(!!e.readOnly||!1),this.addPerson=function(e,t){null==i.modelValue()&&i.modelValue([]);var o=!1;return ko.utils.arrayForEach(i.modelValue(),function(e){e==i.person()&&(o=!0)}),o?this.shake(t):(i.modelValue().push(i.person()),i.modelValue.valueHasMutated(),i.person(null)),!1},this.removePerson=function(t,e){try{i.modelValue.remove(t)}catch(e){var o=i.modelValue().indexOf(t);-1<o&&(i.modelValue().splice(i.modelValue().indexOf(t),1),i.modelValue.valueHasMutated())}return!1},this.showRequiredText=ko.pureComputed(function(){return!!i.required&&(!i.modelValue()||i.modelValue().length<1)}),this.shake=function(e){var t=$("button[id="+e.currentTarget.id+"]");t.css("position","relative");for(var o=1;o<=3;o++)t.removeClass("btn-success").addClass("btn-danger").animate({left:-5},200/3/4).animate({left:5},200/3/2).animate({left:0},200/3/4),setTimeout(function(){t.removeClass("btn-danger btn-warning").addClass("btn-success")},1e3)}},template:p.Templates.soUsermultiField}),ko.components.register("so-static-field",{viewModel:t,template:p.Templates.soStaticField}),ko.components.register("so-static-person",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spPerson: modelValue')}),ko.components.register("so-static-date",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDate: modelValue')}),ko.components.register("so-static-datetime",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDateTime: modelValue')}),ko.components.register("so-static-money",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spMoney: modelValue')}),ko.components.register("so-static-number",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spNumber: modelValue')}),ko.components.register("so-static-decimal",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDecimal: modelValue')}),ko.components.register("so-static-html",{viewModel:t,template:p.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="html: modelValue')}),ko.components.register("so-attachments",{viewModel:function(e){var s=this,t=window;if(this.errorMsg=ko.observable(null),!e)throw this.errorMsg("`params` is undefined in component so-attachments"),this.errorMsg();if(!e.val)throw this.errorMsg("Parameter `val` for component so-attachments is required!"),this.errorMsg();var l,d,o,c=e.val.getSpForm(),i=c.getViewModel(),u=e.allowedExtensions||c.allowedExtensions;this.attachments=e.val,this.label=e.label||"Attach Files",this.drop=e.drop||!0,this.dropLabel=e.dropLabel||"...or Drag and Drop Files Here",this.className=e.className||"btn btn-primary",this.title=e.title||"Attachments",this.description=e.description,this.readOnly="function"==typeof e.readOnly?e.readOnly:ko.observable(e.readOnly||!1),this.length=ko.pureComputed(function(){return s.attachments().length}),this.fileUploads=ko.observableArray(),this.hasFileReader=ko.observable(t.File&&t.FileReader&&t.FileList&&t.Blob),this.hasFileReader()||this.errorMsg("This browser does not support the FileReader class required for uplaoding files. You may be using IE 9 or another unsupported browser.");function n(e){o=[];var t=Array.prototype.slice.call(e,0);t.map(function(e,t){o.push(function(){!function(e){c.debug&&(console.info("uploading file..."),console.info(e));var n=e.name.replace(/[^a-zA-Z0-9_\-\.]/g,""),t=/\.\w{2,4}$/.exec(n)[0],o=n.replace(new RegExp(t+"$"),"");if(!new RegExp("^(\\.|)("+u.join("|")+")$","i").test(t))return s.errorMsg("Only files with the extensions: "+u.join(", ")+" are allowed.");for(var i=0;i<s.attachments().length;i++)if(new RegExp(n,"i").test(s.attachments()[i].Name)){n=o+"-1"+t;break}var a=new p.FileUpload(n,e.size);function r(){var e=arguments[1];if(c.debug&&(console.info("so-html5-attachments.onFileUploadComplete()..."),console.info(arguments)),e||"error"!=e){if("success"==e){var t=new p.SpAttachment(c.getRootUrl(),c.siteUrl,c.listName,c.getItemId(),n);s.attachments().push(t),s.attachments.valueHasMutated(),d.next(!0)}}else{var o=arguments[0],i=(o.responseXML,$(o.responseXML).find("errorstring").text());i&&c.$dialog.html("Error on file upload. Message from server: "+(i||o.statusText)).dialog("open"),a.className(a.className().replace("-success","-danger")),d.next(!1)}setTimeout(function(){s.fileUploads.remove(a)},1e3)}s.fileUploads().push(a),s.fileUploads.valueHasMutated(),(l=new FileReader).onerror=function(e){var t=e,o=a.className();switch(a.className(o.replace("-success","-danger")),t.target.error.code){case t.target.error.NOT_FOUND_ERR:s.errorMsg="File Not Found!";break;case t.target.error.NOT_READABLE_ERR:s.errorMsg="File is not readable.";break;case t.target.error.ABORT_ERR:break;default:s.errorMsg="An error occurred reading this file."}},l.onprogress=function(e){!function(e,t){if(e.lengthComputable){var o=Math.round(e.loaded/e.total*100);o<100&&t.progress(o)}}(e,a)},l.onabort=function(e){s.errorMsg("File read cancelled")},l.onloadstart=function(e){a.progress(0)},l.onload=function(e){var t=e;a.progress(100),p.SpSoap.addAttachment(t.target.result,n,c.listName,c.viewModel.Id(),c.siteUrl,r)},l.onloadend=function(e){},l.readAsDataURL(e)}(e)})}),d=new p.Cafe(o),null==i.Id()?c.saveListItem(i,!1,void 0,function(e){null==i.Id()&&e&&e.toFixed&&i.Id(e),setTimeout(function(){d.next(!0)},1e3)}):d.next(!0)}function a(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()}this.id=e.id||"so_fileUploader_"+r(),this.deleteAttachment=function(o,e){confirm("Are you sure you want to delete "+o.Name+"? This can't be undone.")&&p.SpApi.deleteAttachment(o,function(e,t){t?alert("Failed to delete attachment: "+t):s.attachments.remove(o)})},this.fileHandler=function(e){n(document.getElementById(s.id).files)},this.onSelect=function(e){a(e),document.getElementById(s.id).click()},this.onDrop=function(e,t){a(t),c.debug&&(console.info("dropped files over dropzone, arguments are..."),console.info(arguments));var o=(t.originalEvent||t).dataTransfer.files;if(!o)return console.warn("Error in so-attachments - event.dataTransfer.files is "+typeof o),!1;n(o)},this.onDragenter=a,this.onDragover=a,c.enableAttachments||(this.errorMsg("Attachments are disabled for this form or SharePoint list."),this.readOnly(!0))},template:p.Templates.soAttachments}),ko.components.register("so-created-modified-info",{viewModel:function(e){this.CreatedBy=e.createdBy,this.ModifiedBy=e.modifiedBy,this.profiles=ko.observableArray([{header:"Created By",profile:this.CreatedBy},{header:"Modified By",profile:this.ModifiedBy}]),this.Created=e.created,this.Modified=e.modified,this.showUserProfiles=e.showUserProfiles},template:p.Templates.soCreatedModifiedInfo}),ko.components.register("so-nav-menu",{viewModel:function(e){this.navMenuItems=e.val,this.title=e.title||"Navigation"},template:p.Templates.soNavMenu}),ko.components.register("so-workflow-history",{viewModel:function(e){this.historyItems=e.val||e.historyItems},template:p.Templates.soWorkflowHistory})},e}();p.KoComponents=e}(Shockout||(Shockout={})),function(c){var e=function(){function d(){}return d.peopleSearch=function(e,o,t){void 0===t&&(t=10);var i="startswith(Name,'{0}')".replace(/\{0\}/g,e);d.getListItems("UserInformationList",function(e,t){if(t)return void o(null,t);o(e,t)},"/",i,null,"Name",10,!0)},d.searchUsers=function(e,o,t,i){void 0===t&&(t="Id,Account,Name,WorkEmail"),void 0===i&&(i=10),d.executeRestRequest("/_vti_bin/listdata.svc/UserInformationList?\n            $filter=startswith(WorkEmail, '"+e+"') or startswith(Name, '"+e+"') or startswith(LastName, '"+e+"') and ContentType eq 'Person'\n            &$orderby=Name\n            &$top="+i,function(e,t){if(t)return void o(e,t);e&&(e.d?o(e.d):o(e))},!0,"GET")},d.getPersonById=function(e,o){isNaN(parseInt(e+""))||d.executeRestRequest("/_vti_bin/listdata.svc/UserInformationList("+e+")",function(e,t){if(t)return void o(e,t);e&&(e.d?o(e.d):o(e))},!0,"GET")},d.executeRestRequest=function(e,n,t,o){void 0===t&&(t=!1),void 0===o&&(o="GET");var i=$.ajax({url:e,type:o,cache:t,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});i.done(function(e,t,o){n(e)}),i.fail(function(e,t,o){if(t&&404==parseInt(t))var i=t+". The data may have been deleted by another user.";else i=t+" "+o;n(null,i)})},d.getListItem=function(e,t,o,i,n,a){void 0===i&&(i="/"),void 0===n&&(n=!1),void 0===a&&(a=null);var r=(i=c.Utils.formatSubsiteUrl(i))+"_vti_bin/listdata.svc/"+c.Utils.toCamelCase(e)+"("+t+")?$expand=CreatedBy,ModifiedBy"+(a?","+a:"");d.executeRestRequest(r,function(e,t){if(t)return void o(e,t);e&&(e.d?o(e.d):o(e))},n,"GET")},d.getListItems=function(e,i,t,o,n,a,r,s){void 0===t&&(t="/"),void 0===o&&(o=null),void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=10),void 0===s&&(s=!1);var l=[(t=c.Utils.formatSubsiteUrl(t))+"_vti_bin/listdata.svc/"+c.Utils.toCamelCase(e)];o&&l.push("$filter="+o),n&&l.push("$select="+n),a&&l.push("$orderby="+a),l.push("$top="+r),d.executeRestRequest(l.join("&").replace(/\&/,"?"),function(e,t){var e=e&&"d"in e?e.d:e,o=null;e&&(o="results"in e?e.results:e);i(o,t)},s,"GET")},d.insertListItem=function(e,i,t){void 0===t&&(t=void 0);var o=$.ajax({url:e,type:"POST",processData:!1,contentType:"application/json",data:t?JSON.stringify(t):null,headers:{Accept:"application/json;odata=verbose"}});o.done(function(e,t,o){i(e)}),o.fail(function(e,t,o){i(null,t+": "+o)})},d.updateListItem=function(t,i,e){void 0===e&&(e=void 0);var o=$.ajax({url:t.__metadata.uri,type:"POST",processData:!1,contentType:"application/json",data:e?JSON.stringify(e):null,beforeSend:function(e){e.setRequestHeader("X-HTTP-Method","MERGE"),e.setRequestHeader("If-Match",t.__metadata.etag)}});o.done(function(e,t,o){i(e)}),o.fail(function(e,t,o){i(null,t+": "+o)})},d.deleteListItem=function(e,i){var t=$.ajax({url:e.__metadata.uri,type:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","If-Match":e.__metadata.etag}});t.done(function(e,t,o){i(e)}),t.fail(function(e,t,o){i(null,o)})},d.deleteAttachment=function(e,i){var t=$.ajax({url:e.__metadata.uri,type:"POST",dataType:"json",contentType:"application/json",headers:{Accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE"}});t.done(function(e,t,o){i(e)}),t.fail(function(e,t,o){i(null,t+": "+o)})},d}();c.SpApi=e}(Shockout||(Shockout={})),function(u){var e=function(){function c(){}return c.getCurrentUser=function(s,l,e){void 0===l&&(l=!0),void 0===e&&(e="");var t=u.Utils.formatSubsiteUrl(e),o=$.ajax({url:t+"_api/Web/CurrentUser"+(l?"?$expand=Groups":""),type:"GET",cache:!0,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});return o.done(function(e,t,o){var i=e.d,n=i.LoginName.replace(/^i\:0\#\.w\|/,""),a={account:i.Id+";#"+i.Title,department:null,email:i.Email,groups:[],id:i.Id,jobtitle:null,login:n,title:i.Title};if(l){var r=e.d.Groups;$(r.results).each(function(e,t){a.groups.push({id:t.Id,name:t.Title})})}s&&s(a)}),o.fail(function(e,t,o){s&&s(null,e.status)}),o},c.getUsersGroups=function(e,r,t){void 0===r&&(r=void 0),void 0===t&&(t="");var o=u.Utils.formatSubsiteUrl(t)+"_api/Web/GetUserById("+e+")/Groups",i=$.ajax({url:o,type:"GET",cache:!0,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});return i.done(function(e,t,o){for(var i=[],n=0;n<e.d.results.length;n++){var a=e.d.results[n];i.push({id:a.Id,name:a.Title})}r&&r(i)}),i.fail(function(e,t,o){r&&r(null,o)}),i},c.SendEmail=function(e,t,o,i,n){var a=u.Utils.formatSubsiteUrl(e)+"_api/SP.Utilities.Utility.SendEmail";return c.Post(e,a,{properties:{__metadata:{type:"SP.Utilities.EmailProperties"},From:t,To:{results:[o]},Body:i,Subject:n}})},c.Post=function(e,i,t,n){void 0===n&&(n=void 0);var a=$.Deferred(),r=t?JSON.stringify(t):null;return c.GetFormDigest(e).then(function(e){var t={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":e.d.GetContextWebInformation.FormDigestValue,"X-HTTP-Method":"POST"};if(n)for(var o in n)t[o]=n[o];$.ajax({contentType:"application/json;odata=verbose",url:i,type:"POST",data:r,headers:t,success:function(e,t,o){a.resolve(e.d||e)},error:function(e,t,o){a.reject({xhr:e,status:t,error:o}),console.warn(o)}})}),a.promise()},c.Get=function(e,t){void 0===t&&(t=!1);var n=$.Deferred(),o=$.ajax({url:e,type:"GET",cache:t,dataType:"json",contentType:"application/json; charset=utf-8",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"}});return o.done(function(e,t,o){n.resolve(e.d||e)}),o.fail(function(e,t,o){if(t&&404==parseInt(t))var i=t+". The data may have been deleted by another user.";else i=t+" "+o;n.reject(i)}),n.promise()},c.GetListItem=function(e,t,o,i,n){void 0===o&&(o="/"),void 0===i&&(i=!1),void 0===n&&(n=void 0);var a=u.Utils.formatSubsiteUrl(o)+"_api/web/lists/GetByTitle('"+e+"')/items("+t+")"+(n?"?$expand="+n:"");return c.Get(a,i)},c.GetFormDigest=function(e){var t={url:u.Utils.formatSubsiteUrl(e)+"_api/contextinfo",method:"POST",headers:{Accept:"application/json;odata=verbose"}};return $.ajax(t)},c.SaveListItem=function(e,t,o,i,n){void 0===n&&(n=void 0);var a=u.Utils.formatSubsiteUrl(e)+"_api/web/lists/GetByTitle('"+t+"')/items"+(n?"("+n+")":""),r=void 0;n&&(r={"X-HTTP-Method":"MERGE","If-Match":"*"});var s={__metadata:{type:function(e){var t=e.replace(/\s/g,"_x0020_"),o="SP.Data."+t+"ListItem";if(new RegExp(o).test(t))return t;return o}(o)}};for(var l in i){var d=i[l];null==d||null==d?s[l]=null:d.constructor===Array?s[l]={__metadata:{type:"Collection(Edm.String)"},results:d}:s[l]=d}return c.Post(e,a,s,r)},c}();u.SpApi15=e}(Shockout||(Shockout={})),function(u){var e=function(){function c(){}return c.getCurrentUser=function(i){var n={};c.getListItems("","User Information List",'<ViewFields><FieldRef Name="ID" /><FieldRef Name="Name" /><FieldRef Name="EMail" /><FieldRef Name="Department" /><FieldRef Name="JobTitle" /><FieldRef Name="UserName" /><FieldRef Name="Office" /></ViewFields>','<Query><Where><Eq><FieldRef Name="ID" /><Value Type="Counter"><UserID /></Value></Eq></Where></Query>',function(e,t,o){$(e).find("*").filter(function(){return u.Utils.isZrow(this)}).each(function(e,t){n.id=parseInt($(t).attr("ows_ID")),n.title=$(t).attr("ows_Title"),n.login=$(t).attr("ows_Name"),n.email=$(t).attr("ows_EMail"),n.jobtitle=$(t).attr("ows_JobTitle"),n.department=$(t).attr("ows_Department"),n.account=n.id+";#"+n.title,n.groups=[]}),i(n)})},c.getUsersGroups=function(e,a,t){void 0===t&&(t="");var o='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetGroupCollectionFromUser xmlns="http://schemas.microsoft.com/sharepoint/soap/directory/"><userLoginName>'+e+"</userLoginName></GetGroupCollectionFromUser></soap:Body></soap:Envelope>",i=$.ajax({url:u.Utils.formatSubsiteUrl(t)+"_vti_bin/usergroup.asmx",type:"POST",dataType:"xml",data:o,contentType:'text/xml; charset="utf-8"'});function n(e,t,o){var i=$(e).find("errorstring");if(i&&""!=i.text())a(null,i.text());else{var n=[];$(e).find("Group").each(function(e,t){n.push({id:parseInt($(t).attr("ID")),name:$(t).attr("Name")})}),a(n)}}i.done(n),i.fail(n)},c.getListItems=function(e,t,o,i,n,a){void 0===a&&(a=25),e=u.Utils.formatSubsiteUrl(e),t||u.Utils.logError("Parameter `listName` is null or undefined in method SpSoap.getListItems()",u.SPForm.errorLogListName,u.SPForm.errorLogSiteUrl);var r='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+t+"</listName><query>"+i+"</query><viewFields>"+o+"</viewFields><rowLimit>"+a+"</rowLimit></GetListItems></soap:Body></soap:Envelope>",s=$.ajax({url:e+"_vti_bin/lists.asmx",type:"POST",dataType:"xml",data:r,headers:{SOAPAction:"http://schemas.microsoft.com/sharepoint/soap/GetListItems","Content-Type":"text/xml; charset=utf-8"}});s.done(function(e,t,o){n(e)}),s.fail(function(e,t,o){n(null,t+": "+o)})},c.getList=function(e,t,i){e=u.Utils.formatSubsiteUrl(e);var o='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName></GetList></soap:Body></soap:Envelope>'.replace("{0}",t),n=$.ajax({url:e+"_vti_bin/lists.asmx",type:"POST",cache:!1,dataType:"xml",data:o,headers:{SOAPAction:"http://schemas.microsoft.com/sharepoint/soap/GetList","Content-Type":"text/xml; charset=utf-8"}});n.done(function(e,t,o){i(e)}),n.fail(function(e,t,o){i(null,t+": "+o)})},c.checkInFile=function(e,t,o,i){void 0===i&&(i="");var n=[e,i,t];return this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/CheckInFile",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckInFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>{0}</pageUrl><comment>{1}</comment><CheckinType>{2}</CheckinType></CheckInFile></soap:Body></soap:Envelope>',n,null,o)},c.checkOutFile=function(e,t,o,i){var n=[e,t,o];return this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/CheckOutFile",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>{0}</pageUrl><checkoutToLocal>{1}</checkoutToLocal><lastmodified>{2}</lastmodified></CheckOutFile></soap:Body></soap:Envelope>',n,null,i)},c.executeSoapRequest=function(e,t,o,i,n,a){void 0===i&&(i="/"),void 0===n&&(n=void 0),void 0===a&&(a="lists.asmx"),i=u.Utils.formatSubsiteUrl(i);try{var r=i+"_vti_bin/"+a;if(null!=o)for(var s=0;s<o.length;s++)t=t.replace("{"+s+"}",null==o[s]?"":o[s]);var l=$.ajax({url:r,cache:!1,type:"POST",data:t,headers:{"Content-Type":"text/xml; charset=utf-8",SOAPAction:e}});n&&l.done(n),l.fail(function(e,t,o){var i="Error in SpSoap.executeSoapRequest. "+t+": "+o+" ";u.SPForm.enableErrorLog&&!u.SPForm.DEBUG&&u.Utils.logError(i,u.SPForm.errorLogListName),n&&n(e,t,o)})}catch(e){u.Utils.logError("Error in SpSoap.executeSoapRequest.",JSON.stringify(e),u.SPForm.errorLogListName),console.warn(e)}},c.updateListItem=function(e,t,o,i,n,a){void 0===i&&(i=!0),void 0===n&&(n="/"),void 0===a&&(a=void 0);for(var r=i?"New":"Update",s=[t],l="<Batch OnError='Continue'><Method ID='1' Cmd='"+r+"'>",d=0;d<o.length;d++)l+="<Field Name='"+o[d][0]+"'>"+u.Utils.escapeColumnValue(o[d][1])+"</Field>";"New"!==r&&(l+="<Field Name='ID'>"+e+"</Field>"),l+="</Method></Batch>",s.push(l),c.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName><updates>{1}</updates></UpdateListItems></soap:Body></soap:Envelope>',s,n,a)},c.searchPrincipals=function(e,i,t,o){void 0===t&&(t=10),void 0===o&&(o="User");c.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/SearchPrincipals",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SearchPrincipals xmlns="http://schemas.microsoft.com/sharepoint/soap/"><searchText>{0}</searchText><maxResults>{1}</maxResults><principalType>{2}</principalType></SearchPrincipals></soap:Body></soap:Envelope>',[e,t,o],"/",function(e,t,o){var n=[];$(e).find("PrincipalInfo").each(function(e,t){var o=parseInt($("UserInfoID",t).text());if(0<o){var i=$("AccountName",t).text().replace(/^i\:0\#\.w\|/,"");n.push({AccountName:i,UserInfoID:o,DisplayName:$("DisplayName",t).text(),Email:$("Email",t).text(),Title:$("Title",t).text(),IsResolved:"true"==$("IsResolved",t).text(),PrincipalType:$("PrincipalType",t).text()})}}),i(n)},"People.asmx")},c.addAttachment=function(e,t,o,i,n,a){var r=-1<e.indexOf(",")?e.split(",")[1]:e;this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/AddAttachment",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><AddAttachment xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName><listItemID>{1}</listItemID><fileName>{2}</fileName><attachment>{3}</attachment></AddAttachment></soap:Body></soap:Envelope>',[o,i,t,r],n,a,"lists.asmx")},c}();u.SpSoap=e}(Shockout||(Shockout={})),function(e){var t=function(e,t){this._description=e||null,this._dateOccurred=t||null};e.HistoryItem=t;var o=function(){};e.SpItem=o}(Shockout||(Shockout={})),function(e){var t=function(){function i(){}return i.getFormAction=function(){var e=document.createElement("div");return e.className="form-action no-print",e.innerHTML=i.soFormAction,e},i.buttonDefault="btn btn-sm btn-default no-print",i.calendarIcon='<span class="glyphicon glyphicon-calendar"></span>',i.personIcon='<span class="glyphicon glyphicon-user"></span>',i.resetButton="btn btn-sm btn-default no-print reset",i.timeControlsHtml='<span class="glyphicon glyphicon-calendar"></span>\n            <select class="form-control so-select-hours" style="margin-left:1em; max-width:5em; display:inline-block;">{0}</select><span> : </span>\n            <select class="form-control so-select-minutes" style="width:5em; display:inline-block;">{1}</select>\n            <select class="form-control so-select-tt" style="margin-left:1em; max-width:5em; display:inline-block;"><option value="AM">AM</option><option value="PM">PM</option></select>\n            <button class="btn btn-sm btn-default reset" style="margin-left:1em;">Reset</button>\n            <span class="error no-print" style="display:none;">Invalid Date-time</span>\n            <span class="so-datetime-display no-print" style="margin-left:1em;"></span>',i.getTimeControlsHtml=function(){for(var e=[],t=1;t<=12;t++)e.push('<option value="'+t+'">'+(t<10?"0"+t:t)+"</option>");var o=[];for(t=0;t<60;t++)o.push('<option value="'+t+'">'+(t<10?"0"+t:t)+"</option>");return i.timeControlsHtml.replace("{0}",e.join("")).replace("{1}",o.join(""))},i.soFormAction='<div class="row">\n            <div class="col-sm-8 col-sm-offset-4 text-right">\n                <label>Logged in as:</label><span data-bind="text: currentUser().title" class="current-user"></span>\n                <button class="btn btn-default cancel" data-bind="event: { click: cancel }" title="Close"><span class="glyphicon glyphicon-remove"></span><span class="hidden-xs">Close</span></button>\n                \x3c!-- ko if: allowPrint() --\x3e\n                    <button class="btn btn-primary print" data-bind="event: {click: print}" title="Print"><span class="glyphicon glyphicon-print"></span><span class="hidden-xs">Print</span></button>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko if: allowDelete() && Id() != null --\x3e\n                    <button class="btn btn-warning delete" data-bind="event: {click: deleteItem}" title="Delete"><span class="glyphicon glyphicon-remove"></span><span class="hidden-xs">Delete</span></button>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko if: allowSave() --\x3e\n                    <button class="btn btn-success save" data-bind="event: { click: save }" title="Save your work."><span class="glyphicon glyphicon-floppy-disk"></span><span class="hidden-xs">Save</span></button>\n                \x3c!-- /ko --\x3e\n                <button class="btn btn-danger submit" data-bind="event: { click: submit }" title="Submit for routing."><span class="glyphicon glyphicon-floppy-open"></span><span class="hidden-xs">Submit</span></button>\n            </div>\n        </div>',i.hasErrorCssDiv="<div class=\"form-group\" data-bind=\"css: {'has-error': !!!modelValue() && !!required(), 'has-success has-feedback': !!modelValue() && !!required()}\">",i.requiredFeedbackSpan='<span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>',i.soNavMenuControl='<so-nav-menu params="val: navMenuItems"></so-nav-menu>',i.soNavMenu='<nav class="navbar navbar-default no-print" id="TOP">\n            <div class="navbar-header">\n                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">\n                <span class="sr-only">Toggle navigation</span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                </button>\n            </div>\n            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n                <ul class="nav navbar-nav" data-bind="foreach: navMenuItems">\n                    <li><a href="#" data-bind="html: title, attr: {\'href\': \'#\' + anchorName }"></a></li>\n                </ul>\n            </div>\n        </nav>',i.soStaticField='<div class="form-group">\n            <div class="row">\n                \x3c!-- ko if: !!label --\x3e\n                    <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label"></label></div>\n                \x3c!-- /ko --\x3e\n                <div class="col-sm-9" data-bind="text: modelValue, attr:{\'class\': fieldColWidth}"></div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n            <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',i.soTextField=i.hasErrorCssDiv+'\n        <div class="row">\n\t        \x3c!-- ko if: !!label --\x3e\n\t\t        <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n\t        \x3c!-- /ko --\x3e\n\t        <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n\t\t        \x3c!-- ko if: readOnly() --\x3e\n\t\t\t        <div data-bind="text: modelValue"></div>\n\t\t        \x3c!-- /ko --\x3e\n\t\t        \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t        \x3c!-- ko if: multiline --\x3e\n\t\t\t\t        <textarea data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, placeholder: placeholder, title: title, required: required, \'ko-name\': koName }" class="form-control"></textarea>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko ifnot: multiline --\x3e\n\t\t\t\t        <input type="text" data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, placeholder: placeholder, title: title, required: required, maxlength: maxlength, \'ko-name\': koName }" class="form-control" />\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko if: !!required() --\x3e\n\t\t\t\t        '+i.requiredFeedbackSpan+'\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        \x3c!-- /ko --\x3e\n\t        </div>\n\t        \x3c!-- ko if: description --\x3e\n\t\t    <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t        \x3c!-- /ko --\x3e\n        </div>',i.soAttachments='<section class="nav-section">\n            <h4><span data-bind="text: title"></span> &ndash; <span data-bind="text: length" class="badge"></span></h4>\n            <div data-bind="visible: !!errorMsg()" class="alert alert-danger alert-dismissable">\n                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <span class="glyphicon glyphicon-exclamation-sign"></span>&nbsp;<span data-bind="text: errorMsg"></span>\n            </div>\n            \x3c!-- ko ifnot: hasFileReader() --\x3e\n            <div data-bind="visible: !!!readOnly(), attr: {id: this.qqFileUploaderId}"></div>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !readOnly() && hasFileReader() --\x3e\n                <div class="row">\n                    <div class="col-md-2 so-attach-files-btn">\n                        <input type="file" data-bind="attr: {\'id\': id}, event: {\'change\': fileHandler}" multiple class="form-control" style="display:none;" />\n                        <div data-bind="attr:{\'class\': className}, event: {\'click\': onSelect}"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;<span data-bind="text: label"></span></div>\n                    </div>\n                    <div class="col-md-10">\n                        \x3c!-- ko if: drop --\x3e\n                            <div class="so-file-dropzone" data-bind="event: {\'dragenter\': onDragenter, \'dragover\': onDragover, \'drop\': onDrop}">\n                                <div><span data-bind="text: dropLabel"></span> <span class="glyphicon glyphicon-upload"></span></div>\n                            </div>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                </div>\n                \x3c!-- ko foreach: fileUploads --\x3e\n                    <div class="progress">\n                        <div data-bind="attr: {\'aria-valuenow\': progress(), \'style\': \'width:\' + progress() + \'%;\', \'class\': className() }" role="progressbar" aria-valuemin="0" aria-valuemax="100">\n                            <span data-bind="text: fileName"></span>\n                        </div>\n                    </div>\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n            <div data-bind="foreach: attachments" style="margin:1em auto;">\n                <div class="so-attachment">\n                    <a href="" data-bind="attr: {href: __metadata.media_src}"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;<span data-bind="text: Name"></span></a>\n                    \x3c!-- ko ifnot: $parent.readOnly() --\x3e\n                    <button data-bind="event: {click: $parent.deleteAttachment}" class="btn btn-sm btn-danger delete" title="Delete Attachment"><span class="glyphicon glyphicon-remove"></span></button>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: length() == 0 && readOnly() --\x3e\n                <p>No attachments have been included.</p>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: description --\x3e\n                <div data-bind="text: description"></div>\n            \x3c!-- /ko --\x3e\n        </section>',i.soHtmlFieldTemplate=i.hasErrorCssDiv+'\n        <div class="row">\n            \x3c!-- ko if: !!label --\x3e\n                <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                \x3c!-- ko if: readOnly() --\x3e\n                    <div data-bind="html: modelValue"></div>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko ifnot: readOnly() --\x3e\n                    <div data-bind="spHtmlEditor: modelValue" contenteditable="true" class="form-control content-editable"></div>\n                    <textarea data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, required: required, \'ko-name\': koName }" data-sp-html="" style="display:none;"></textarea>\n                    \x3c!-- ko if: !!required() --\x3e\n                        '+i.requiredFeedbackSpan+'\n                    \x3c!-- /ko --\x3e\n                \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',i.soCheckboxField='<div class="form-group">\n            <div class="row">\n                <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                    <label data-bind="html: label, attr: {for: id}"></label>\n                    \x3c!-- /ko --\x3e\n                </div>\n                <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                        <div data-bind="text: !!modelValue() ? \'Yes\' : \'No\'"></div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: readOnly() --\x3e\n                        <label class="checkbox">\n                            <input type="checkbox" data-bind="checked: modelValue, css: {\'so-editable\': editable}, attr: {id: id, \'ko-name\': koName}, valueUpdate: valueUpdate" />\n                            <span data-bind="html: label" style="margin-left:1em;"></span>\n                        </label>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',i.soSelectField=i.hasErrorCssDiv+'<div class="row">\n                \x3c!-- ko if: !!label --\x3e\n                    <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n                \x3c!-- /ko --\x3e\n                <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                        <div data-bind="text: modelValue"></div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: readOnly() --\x3e\n                        <select data-bind="value: modelValue, options: options, optionsCaption: caption, css: {\'so-editable\': editable}, attr: {id: id, title: title, required: required, \'ko-name\': koName}" class="form-control"></select>\n                        \x3c!-- ko if: !!required() --\x3e\n                            '+i.requiredFeedbackSpan+'\n                        \x3c!-- /ko --\x3e\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',i.soCheckboxGroup='<div class="form-group">\n            \x3c!-- ko if: description --\x3e\n\t            <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n            <div class="row">\n\t            \x3c!-- ko if: !!label --\x3e\n\t\t            <div><label data-bind="html: label"></label></div>\n\t            \x3c!-- /ko --\x3e\n\t            <div>\n\t\t            \x3c!-- ko if: readOnly() --\x3e\n\t\t\t            \x3c!-- ko ifnot: inline --\x3e\n\t\t\t\t            <ul class="list-group">\n\t\t\t\t\t            \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t\t\t            <li data-bind="text: $data" class="list-group-item"></li>\n\t\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t\t            \x3c!-- ko if: modelValue().length == 0 --\x3e\n\t\t\t\t\t\t            <li class="list-group-item">--None--</li>\n\t\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t            </ul>\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t            \x3c!-- ko if: inline --\x3e\n\t\t\t\t            \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t\t            <span data-bind="text: $data"></span>\n\t\t\t\t\t            \x3c!-- ko if: $index() < $parent.modelValue().length-1 --\x3e,&nbsp;\x3c!-- /ko --\x3e\n\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t            \x3c!-- ko if: modelValue().length == 0 --\x3e\n\t\t\t\t\t            <span>--None--</span>\n\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t            <input type="hidden" data-bind="value: modelValue, attr:{required: !!required}" /><p data-bind="visible: !!required" class="req">(Required)</p>\n\t\t\t            \x3c!-- ko foreach: options --\x3e\n\t\t\t\t            <label data-bind="css:{\'checkbox\': !$parent.inline, \'checkbox-inline\': $parent.inline}">\n\t\t\t\t\t            <input type="checkbox" data-bind="checked: $parent.modelValue, css: {\'so-editable\': $parent.editable}, attr: {\'ko-name\': $parent.koName, \'value\': $data}" />\n\t\t\t\t\t            <span data-bind="text: $data"></span>\n\t\t\t\t            </label>\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- /ko --\x3e\n\t            </div>\n            </div>',i.soRadioGroup='<div class="form-group">\n\t        \x3c!-- ko if: description --\x3e\n\t\t        <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t        \x3c!-- /ko --\x3e\n\t        <div class="row">\n\t\t        \x3c!-- ko if: !!label --\x3e\n\t\t\t        <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label"></label></div>\n\t\t        \x3c!-- /ko --\x3e\n\t\t        <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n\t\t\t        \x3c!-- ko if: readOnly() --\x3e\n\t\t\t\t        <div data-bind="text: modelValue"></div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t\t        \x3c!-- ko foreach: options --\x3e\n\t\t\t\t\t        <label data-bind="css:{\'radio\': !$parent.inline, \'radio-inline\': $parent.inline}">\n\t\t\t\t\t\t        <input type="radio" data-bind="checked: $parent.modelValue, attr:{value: $data, name: $parent.name, \'ko-name\': $parent.koName}, css:{\'so-editable\': $parent.editable}" />\n\t\t\t\t\t\t        <span data-bind="text: $data"></span>\n\t\t\t\t\t        </label>\n\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        </div>\n\t        </div>\n        </div>',i.soUsermultiField='<div class="form-group">\n\t        <input type="hidden" data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, \'ko-name\': koName, required: required}" />\n\t        <div class="row">\n\t\t        <div class="col-md-3 col-xs-3">\n\t\t\t        <label data-bind="html: label"></label>\n\t\t        </div>\n\t\t        <div class="col-md-9 col-xs-9">\n\t\t\t        \x3c!-- ko ifnot: readOnly --\x3e\n\t\t\t\t        <input type="text" data-bind="spPerson: person, attr: {placeholder: placeholder}" />\n\t\t\t\t        <button class="btn btn-success" data-bind="click: addPerson, attr: {\'disabled\': person() == null, id: koName + \'_AddButton\' }"><span>Add</span></button>\n\t\t\t\t        \x3c!-- ko if: showRequiredText --\x3e\n\t\t\t\t\t        <div class="col-md-6 col-xs-6">\n\t\t\t\t\t\t        <p class="text-danger">At least one person must be added.</p>\n\t\t\t\t\t        </div>\n\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t        <div class="row">\n\t\t\t\t\t        <div class="col-md-10 col-xs-10" data-bind="spPerson: $data"></div>\n\t\t\t\t\t        \x3c!-- ko ifnot: $parent.readOnly() --\x3e\n\t\t\t\t\t\t        <div class="col-md-2 col-xs-2">\n\t\t\t\t\t\t\t        <button class="btn btn-xs btn-danger" data-bind="click: $parent.removePerson"><span class="glyphicon glyphicon-trash"></span></button>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t\t        </div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko if: description --\x3e\n\t\t\t\t        <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        </div>\n\t        </div>\n        </div>',i.soWorkflowHistoryControl='\x3c!-- ko if: !!Id() && historyItems().length > 0 --\x3e\n            <section id="workflowHistory" class="nav-section">\n                <h4>Workflow History</h4>\n                <so-workflow-history params="val: historyItems"></so-workflow-history>\n            </section>\n        \x3c!-- /ko --\x3e',i.soWorkflowHistory='<div class="row">\n            <div class="col-sm-8"><strong>Description</strong></div>\n            <div class="col-sm-4"><strong>Date</strong></div>\n        </div>\n        \x3c!-- ko foreach: historyItems --\x3e\n            <div class="row">\n                <div class="col-sm-8"><span data-bind="text: _description"></span></div>\n                <div class="col-sm-4"><span data-bind="spDateTime: _dateOccurred"></span></div>\n            </div>\n        \x3c!-- /ko --\x3e',i.soCreatedModifiedInfoControl='\x3c!-- ko if: !!CreatedBy && CreatedBy() != null --\x3e\n            <section class="nav-section">\n                <h4>Created/Modified By</h4>\n                <so-created-modified-info params="created: Created, createdBy: CreatedBy, modified: Modified, modifiedBy: ModifiedBy, showUserProfiles: showUserProfiles"></so-created-modified-info>\n            </section>\n        \x3c!-- /ko --\x3e',i.soCreatedModifiedInfo='\x3c!-- ko if: showUserProfiles() --\x3e\n            <div class="create-mod-info no-print hidden-xs">\n                \x3c!-- ko foreach: profiles --\x3e\n                    <div class="user-profile-card">\n                        <h4 data-bind="text: header"></h4>\n                        \x3c!-- ko with: profile --\x3e\n                            <img data-bind="attr: {src: Picture, alt: Name}" />\n                            <ul>\n                                <li><label>Name</label><span data-bind="text: Name"></span><li>\n                                <li><label>Job Title</label><span data-bind="text: JobTitle"></span></li>\n                                <li><label>Department</label><span data-bind="text: Department"></span></li>\n                                <li><label>Email</label><a data-bind="text: WorkEMail, attr: {href: (\'mailto:\' + WorkEMail)}"></a></li>\n                                <li><label>Phone</label><span data-bind="text: WorkPhone"></span></li>\n                                <li><label>Office</label><span data-bind="text: Office"></span></li>\n                            </ul>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                \x3c!-- /ko --\x3e\n            </div>\n        \x3c!-- /ko --\x3e\n        <div class="row">\n            \x3c!-- ko with: CreatedBy --\x3e\n                <div class="col-md-3"><label>Created By</label> <a data-bind="text: Name, attr: {href: \'mailto:\' + WorkEMail}" class="email"> </a></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-md-3"><label>Created</label> <span data-bind="spDateTime: Created"></span></div>\n            \x3c!-- ko with: ModifiedBy --\x3e\n                <div class="col-md-3"><label>Modified By</label> <a data-bind="text: Name, attr: {href: \'mailto:\' + WorkEMail}" class="email"></a></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-md-3"><label>Modified</label> <span data-bind="spDateTime: Modified"></span></div>\n        </div>',i}();e.Templates=t}(Shockout||(Shockout={})),function(r){var e=function(){function d(){}return d.tail=function(e){if(null==e||null==e)return e;if(e.constructor!==Array)return e;var t=e.length;return 0<t?e[t-1]:void 0},d.indexOf=function(e,t){if(Array.prototype.indexOf)return Array.prototype.indexOf.apply(e,[t]);for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1},d.formatSubsiteUrl=function(e){return e?/\/$/.test(e)?e:e+"/":"/"},d.toCamelCase=function(e){return e.toString().replace(/\s*\b\w/g,function(e){return(e[1]||e[0]).toUpperCase()}).replace(/\s/g,"").replace(/\'s/,"S").replace(/[^A-Za-z0-9\s_]/g,"")},d.getIdFromHash=function(){var e=window.location!=window.parent.location?document.referrer:document.location.href,t=/#\/id\/\d+/i.exec(e),o=t?t[0].replace(/\D/g,""):null;return/\d/.test(o)?parseInt(o):null},d.setIdHash=function(e){window.location.hash="#/id/"+e},d.escapeColumnValue=function(e){return"string"==typeof e?e.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):e},d.getParent=function(e,t){void 0===t&&(t=1);for(var o=0;o<t;o++)e&&(e=e.parentNode);return e},d.getPrevKOComment=function(e){for(;(e=e.previousSibling)&&8!=e.nodeType&&!/^\s*ko/.test(e.textContent););return e},d.getKoComments=function(e){var o=[];return e=e||$("body"),$(e).contents().filter(function(e,t){return 8==t.nodeType&&/^\s*ko/.test(t.nodeValue)}).each(function(e,t){o.push(t.nodeValue.replace(/\s*ko\s*foreach\s*:\s*(\$root\.|)/,"").replace(/\s/g,""))}),o},d.getKoContainerlessControls=function(e){var o=[];return e=e||document.body,$(e).contents().filter(function(e,t){return 8==t.nodeType&&/^\s*ko\s*foreach:/.test(t.nodeValue)}).each(function(e,t){o.push(t)}),o},d.getEditableKoContainerlessControls=function(e){e=e||document.body;for(var t=d.getKoContainerlessControls(e),o=[],i=/(^button|submit|cancel|reset)/i,n=/(input|textarea)/i,a=/\$data/,r=0;r<t.length;r++){var s=d.getNextSibling(t[r]),l=s.getAttribute("data-bind");if(l&&n.test(s.tagName)&&a.test(l)&&i.test(s.getAttribute("type")))o.push(t[r]);else 0<s.querySelectorAll("input[data-bind*='$data']:enabled, textarea[data-bind*='$data']:enabled").length&&o.push(t[r])}return o},d.getEditableKoControlNames=function(e){var n=[],o=/(button|submit|cancel|reset)/,a=/\s*:\s*(\$root.|)\w*\b/;$(e).find("[data-bind]").filter(":input").filter(function(e,t){return!o.test($(t).attr("type"))}).each(t);function t(e,t){var o=a.exec($(t).attr("data-bind")),i=o?o[0].replace(/:(\s+|)/g,"").replace(/\$root\./,"").replace(/\s/g,""):null;null!=i&&n.push(i)}return $(e).find('[data-bind][contenteditable="true"]').each(t),n},d.getEditableKoNames=function(e){e=e||document.body;var i=[];$(e).find(".so-editable[ko-name]").each(function(e,t){var o=$(t).attr("ko-name");d.indexOf(i,o)<0&&i.push(o)});for(var t=d.getEditableKoContainerlessControls(e),o=0;o<t.length;o++){var n=t[o].nodeValue.replace(/\s*ko\s*foreach\s*:\s*(\$root\.|)/,"").replace(/\s/g,"");d.indexOf(i,n)<0&&i.push(n)}var a=d.getEditableKoControlNames(e);for(o=0;o<a.length;o++){n=a[o];d.indexOf(i,n)<0&&i.push(n)}return i},d.getNextSibling=function(e){for(;1!=(e=e.nextSibling).nodeType;);return e},d.observableNameFromControl=function(e,t){void 0===t&&(t=void 0);var o=e.getAttribute("data-bind");if(!o)return null;var i=$(e).attr("ko-name");if(i)return i;var n=/(\b:\s*|\$root\.)\w*\b/.exec(o);return i=n?n[0].replace(/:(\s+|)/g,"").replace(/\$root\./,"").replace(/\s/g,""):null},d.parseJsonDate=function(e){return d.isJsonDateTicks(e)?new Date(parseInt(e.replace(/\D/g,""))):null},d.parseIsoDate=function(e){return d.isIsoDateString(e)?new Date(e):null},d.isJsonDateTicks=function(e){return!!e&&/\/Date\(\d+\)\//.test(e+"")},d.isIsoDateString=function(e){return!!e&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/.test(e+"")},d.getQueryParam=function(e){var t="",o=window.location!=window.parent.location?document.referrer:document.location.href;-1<o.indexOf("?")&&(t="?"+o.split("?")[1]),e=(0,window.escape)((0,window.unescape)(e));var i=new RegExp("[?&]"+e+"(?:=([^&]*))?","i").exec(t);return null!=i?i[1]:null},d.clone=function(e){if(!(e instanceof Object))return e;var t,o=e.constructor;switch(o){case RegExp:t=new o(e);break;case Date:t=new o(e.getTime());break;default:t=new o}for(var i in e)t[i]=d.clone(e[i]);return t},d.logError=function(e,t,o,i){if(void 0===o&&(o="/"),void 0===i&&(i=!1),i||!r.SPForm.enableErrorLog)throw e;o=d.formatSubsiteUrl(o);var n=window.location.href,a='<p>An error occurred at <a href="'+n+'" target="_blank">'+n+"</a></p><p>Message: "+e+"</p>";$.ajax({url:o+"_vti_bin/listdata.svc/"+t.replace(/\s/g,""),type:"POST",processData:!1,contentType:"application/json;odata=verbose",data:JSON.stringify({Title:"Web Form Error",Error:a}),headers:{Accept:"application/json;odata=verbose"}}).fail(function(e){throw e.responseJSON.error})},d.updateKoField=function(e,t){"input"==e.tagName.toLowerCase()?$(e).val(t):$(e).html(t)},d.validateSpPerson=function(e){return null!=e&&null!=e.toString().match(/^\d*;#/)},d.isTime=function(e){if(!e)return!1;return/\d{1,2}:\d{2}(:\d{2}|)\s{0,1}(AM|PM)/.test(e)},d.isDate=function(e){if(!e)return!1;return/\d{1,2}\/\d{1,2}\/\d{4}/.test(e.toString())},d.dateToLocaleString=function(e){try{var t=e.getUTCDate();t=t<10?"0"+t:t;var o=e.getUTCMonth()+1;return(o=o<10?"0"+o:o)+"/"+t+"/"+e.getUTCFullYear()}catch(e){return"Invalid Date"}},d.toTimeLocaleObject=function(e){var t,o,i=0;return o=11<(i=e.getUTCHours())?"PM":"AM",(t=e.getUTCMinutes())<10&&(t="0"+t),12<i&&(i-=12),{hours:i,minutes:t,tt:o}},d.toTimeLocaleString=function(e){var t=e.getUTCHours(),o=e.getUTCMinutes(),i=11<t?"PM":"AM";return o<10&&(o="0"+o),12<t?t-=12:0==t&&(t=12),t+":"+o+" "+i},d.toDateTimeLocaleString=function(e){var t=d.toTimeLocaleString(e);return d.dateToLocaleString(e)+" "+t},d.parseDate=function(e){if(!e)return null;if("object"==typeof e&&e.constructor==Date)return e;var t,o,i,n,a=/\d{1,2}\/\d{1,2}\/\d{2,4}/,r=/\d{4}-\d{1,2}-\d{1,2}/,s=null;return""==(e=r.test(e)?e:(e+"").replace(/[^0-9\/\-]/g,""))?null:(a.test(e)||/\d{1,2}-\d{1,2}-\d{2,4}/.test(e)?(t=a.test(e)?e.split("/"):e.split("-"),o=parseInt(t[0])-1,i=parseInt(t[1]),n=(n=parseInt(t[2]))<100?2e3+n:n,s=new Date(n,o,i,0,0,0,0)):r.test(e)?(t=e.split("-"),n=parseInt(t[0]),o=parseInt(t[1])-1,i=parseInt(t[2]),n=n<100?2e3+n:n,s=new Date(n,o,i,0,0,0,0)):/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/.test(e)?s=new Date(e):/(\/|)\d{13}(\/|)/.test(e)&&(s=new Date(parseInt(e.replace(/\D/g,"")))),s)},d.formatMoney=function(e,t,o){void 0===t&&(t="$"),void 0===o&&(o=2);var i=d.unformatNumber(e),n="%s%v",a=n.replace("%v","-%v"),r=0<i?n:i<0?a:n,s=d.formatNumber(Math.abs(i),d.checkPrecision(o));return r.replace("%s",t).replace("%v",s)},d.unformatNumber=function(e){if("number"==typeof e)return e;var t=parseFloat((e+"").replace(/\((.*)\)/,"-$1").replace(/[^0-9-.]/g,""));return isNaN(t)?0:t},d.formatNumber=function(e,t){void 0===t&&(t=0);var o=d.unformatNumber(e),i=d.checkPrecision(t),n=o<0?"-":"",a=parseInt(d.toFixed(Math.abs(o||0),i),10)+"",r=3<a.length?a.length%3:0;return n+(r?a.substr(0,r)+",":"")+a.substr(r).replace(/(\d{3})(?=\d)/g,"$1,")+(i?"."+d.toFixed(Math.abs(o),i).split(".")[1]:"")},d.isString=function(e){return!!(""===e||e&&e.charCodeAt&&e.substr)},d.toFixed=function(e,t){void 0===t&&(t=0),t=d.checkPrecision(t);var o=Math.pow(10,t);return(Math.round(d.unformatNumber(e)*o)/o).toFixed(t)},d.checkPrecision=function(e){return e=Math.round(Math.abs(e)),isNaN(e)?0:e},d.compareArrays=function(e,t){for(var o=[],i=0;i<e.length;i++)for(var n=0;n<t.length;n++)e[i]==t[n]&&d.indexOf(o,t[n])<0&&o.push(t[n]);return o},d.trim=function(e){return d.isString(e)?e.replace(/(^\s+|\s+$)/g,""):e},d.formatPictureUrl=function(e){return null==e?"/_layouts/images/person.gif":-1<e.indexOf(",")?e.split(",")[0]:e},d.isZrow=function(e){return"z:row"==e.nodeName.toLowerCase()},d.koNameFromControl=d.observableNameFromControl,d}();r.Utils=e}(Shockout||(Shockout={})),function(s){var e=function(e,t,o,i,n){var a=o.replace(/\s/g,""),r=e+(t=s.Utils.formatSubsiteUrl(t))+"_vti_bin/listdata.svc/Attachments(EntitySet='"+a+"',ItemId="+i+",Name='"+n+"')";this.__metadata={uri:r,content_type:"application/octetstream",edit_media:r+"/$value",media_etag:null,media_src:e+t+"/Lists/"+o+"/Attachments/"+i+"/"+n,type:"Microsoft.SharePoint.DataService.AttachmentsItem"},this.EntitySet=a,this.ItemId=i,this.Name=n};s.SpAttachment=e;var t=function(){function e(e){return void 0===e&&(e=void 0),e&&(this.asyncFns=e),this}return e.prototype.start=function(e){void 0===e&&(e=void 0),this.next(!0,e)},e.prototype.complete=function(e){return this._complete=e,this},e.prototype.fail=function(e){return this._fail=e,this},e.prototype.finally=function(e){return this._finally=e,this},e.prototype.next=function(e,t,o){if(void 0===e&&(e=!0),void 0===t&&(t=void 0),void 0===o&&(o=void 0),!this.asyncFns)throw"Error in Cafe: The required parameter `asyncFns` of type (Array<Function>) is undefined. Don't forget to instantiate Cafe with this parameter or set its value after instantiation.";this._complete&&this._complete(t,e,o),e?0!=this.asyncFns.length?this.asyncFns.shift()(this,o):this._finally&&this._finally(t,e,o):this._fail&&this._fail(t,e,o)},e}();s.Cafe=t;var o=function(e,t){var o=this;this.label=ko.observable(null),this.progress=ko.observable(0),this.fileName=ko.observable(e),this.kb=ko.observable(t/1024),this.className=ko.observable("progress-bar progress-bar-info progress-bar-striped active"),this.getProgress=ko.pureComputed(function(){return o.fileName()+" "+o.progress()+"%"},this)};s.FileUpload=o;var i=function(){function t(e,t){var o=this,i=ko.unwrap(t);function n(){o.setModelValue(t)}this.$element=$(e),this.$parent=this.$element.parent(),s.Utils.isJsonDateTicks(i)&&t(s.Utils.parseJsonDate(i)),this.required=this.$element.hasClass("required")||null!=this.$element.attr("required"),this.$element.attr({placeholder:"MM/DD/YYYY",maxlength:10,class:"datepicker med form-control"}).css("display","inline-block").on("change",n).datepicker({changeMonth:!0,changeYear:!0}),this.required&&this.$element.attr("required",""),this.$element.after(s.Templates.getTimeControlsHtml()),this.$display=this.$parent.find(".so-datetime-display"),this.$error=this.$parent.find(".error"),this.$hh=this.$parent.find(".so-select-hours").val("12").on("change",n),this.$mm=this.$parent.find(".so-select-minutes").val("0").on("change",n),this.$tt=this.$parent.find(".so-select-tt").val("AM").on("change",n),this.$reset=this.$parent.find(".btn.reset").on("click",function(){try{o.$element.val(""),o.$hh.val("12"),o.$mm.val("0"),o.$tt.val("AM"),o.$display.html(""),t(null)}catch(e){console.warn(e)}return!1})}return t.prototype.setModelValue=function(e){try{var t=this.$element.val();if(!$.trim(this.$element.val()))return;var o=parseInt(this.$hh.val()),i=parseInt(this.$mm.val()),n=this.$tt.val();"PM"==n&&o<12?o+=12:"AM"==n&&11<o&&(o-=12);var a=new Date(t);a.setUTCHours(o,i,0,0),e(a)}catch(e){if(s.SPForm.DEBUG)throw e}},t.prototype.setDisplayValue=function(e){try{if(!(t=ko.unwrap(e))||t.constructor!=Date)return;var t,o=(t=ko.unwrap(e)).getUTCHours(),i=t.getUTCMinutes();this.$element.val(t.getUTCMonth()+1+"/"+t.getUTCDate()+"/"+t.getUTCFullYear()),12<o?(o-=12,this.$tt.val("PM")):0==o?(o=12,this.$tt.val("AM")):12==o?this.$tt.val("PM"):this.$tt.val("AM"),this.$hh.val(o.toString()),this.$mm.val(i.toString()),this.$display.html(this.toString(e))}catch(e){if(s.SPForm.DEBUG)throw e}},t.prototype.toString=function(e){return t.toString(e)},t.toString=function(e){try{var t=ko.unwrap(e);if(null==t||t.constructor!=Date)return;var o=s.Utils.toDateTimeLocaleString(t),i=/\b\s\(\w+\s\w+\s\w+\)/i.exec(t.toString());return i&&(o+=" "+i[0].replace(/\b\w+/g,function(e){return e[0]}).replace(/\s/g,"")),o}catch(e){if(s.SPForm.DEBUG)throw e}return null},t}();s.DateTimeModel=i}(Shockout||(Shockout={})),function(e){var t=function(){};(Shockout||(Shockout={})).ClassNameDict=t}();