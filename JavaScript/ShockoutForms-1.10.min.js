"use strict";!function(e){var t=function(){function t(o,i,n){void 0===n&&(n=void 0),this.allowDelete=!1,this.allowPrint=!0,this.allowSave=!1,this.allowedExtensions=["txt","rtf","zip","pdf","doc","docx","jpg","gif","png","ppt","tif","pptx","csv","pub","msg","xls","xlsx"],this.attachmentMessage="An attachment is required.",this.confirmationUrl="/SitePages/Confirmation.aspx",this.debug=!1,this.dialogOpts={width:400,height:250,autoOpen:!1,show:{effect:"blind",duration:1e3},hide:{effect:"explode",duration:1e3}},this.editableFields=[],this.enableAttachments=!1,this.enableErrorLog=!0,this.errorLogListName="Error Log",this.errorLogSiteUrl="/",this.fieldNames=[],this.includeUserProfiles=!0,this.includeWorkflowHistory=!0,this.includeNavigationMenu=!0,this.requireAttachments=!1,this.searchPrincipals=!0,this.siteUrl="",this.utils=e.Utils,this.viewModelIsBound=!1,this.workflowHistoryListName="Workflow History",this.currentUser={id:null,title:null,login:null,email:null,account:null,jobtitle:null,department:null,isAdmin:!1,groups:[]},this.itemId=null,this.listId=null,this.listItem=null,this.requireCheckout=!1,this.rootUrl=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),this.sourceUrl=null,this.version="1.0.1",this.queryStringId="formid";var a;if(!(this instanceof t))throw a="You must declare an instance of this class with `new`.",alert(a),a;if(!i||!o){var r=["Missing required parameters:"];throw this.formId||r.push(" `formId`"),this.listName||r.push(" `listName`"),r=r.join(""),alert(r),r}if(this.formId=i,this.listName=o,this.listNameRest=e.Utils.toCamelCase(o),this.form="string"==typeof i?document.getElementById(i):i,this.form){if(this.$form=$(this.form).addClass("sp-form"),$("form").attr({novalidate:"novalidate"}),this.sourceUrl=e.Utils.getQueryParam("source"),this.sourceUrl&&(this.sourceUrl=decodeURIComponent(this.sourceUrl)),n&&n.constructor===Object)for(var s in n)this[s]=n[s];t.DEBUG=this.debug,t.searchPrincipals=this.searchPrincipals,this.itemId=e.Utils.getIdFromHash();var l=e.Utils.getQueryParam(this.queryStringId)||e.Utils.getQueryParam("ID");!this.itemId&&/\d/.test(l)&&(this.itemId=parseInt(l),e.Utils.setIdHash(this.itemId)),t.errorLogListName=this.errorLogListName,t.errorLogSiteUrl=this.errorLogSiteUrl,t.enableErrorLog=this.enableErrorLog,e.KoHandlers.bindKoHandlers(),this.viewModel=new e.ViewModel(this),this.viewModel.showUserProfiles(this.includeUserProfiles),this.$formStatus=$("<div>",{class:"form-status"}).appendTo(this.$form),this.$dialog=$("<div>",{id:"formdialog"}).appendTo(this.$form).dialog(this.dialogOpts),this.asyncFns=[this.getCurrentUserAsync,function(e){e.preRender&&e.preRender(e,e.viewModel),e.nextAsync(!0)},this.getListAsync,this.initForm,function(t,o){void 0===o&&(o=void 0),e.KoComponents.registerKoComponents(),ko.applyBindings(t.viewModel,t.form),t.viewModelIsBound=!0,t.nextAsync(!0)},this.getListItemAsync,this.getHistoryAsync,function(e){e.enableAttachments&&e.getAttachments(e),e.nextAsync(!0)},function(e){e.postRender&&e.postRender(e,e.viewModel),e.nextAsync(!0)},this.implementPermissions,this.finalize],this.nextAsync(!0,"Begin initialization...")}else alert('An element with the ID "'+this.formId+'" was not found. Ensure the `formId` parameter in the constructor matches the ID attribute of the form element.')}return t.prototype.getCurrentUser=function(){return this.currentUser},t.prototype.getDefaultViewUrl=function(){return this.defaultViewUrl},t.prototype.getDefailtMobileViewUrl=function(){return this.defaultMobileViewUrl},t.prototype.getForm=function(){return this.form},t.prototype.getItemId=function(){return this.itemId},t.prototype.setItemId=function(e){this.itemId=e},t.prototype.getListId=function(){return this.listId},t.prototype.getListItem=function(){return this.listItem},t.prototype.requiresCheckout=function(){return this.requireCheckout},t.prototype.getRootUrl=function(){return this.rootUrl},t.prototype.getSourceUrl=function(){return this.sourceUrl},t.prototype.getViewModel=function(){return this.viewModel},t.prototype.getVersion=function(){return this.version},t.prototype.getListItemMetadata=function(){return this.listItemMetadata},t.prototype.nextAsync=function(e,t,o){void 0===e&&(e=!0),void 0===t&&(t=void 0),void 0===o&&(o=void 0);var i=this;t&&this.updateStatus(t,e,i),e&&(0!=this.asyncFns.length?this.asyncFns.shift()(i,o):setTimeout(function(){i.$formStatus.hide()},2e3))},t.prototype.getCurrentUserAsync=function(t,o){void 0===o&&(o=void 0),t.updateStatus("Retrieving your account...",!0,t);t.debug&&console.info("Testing for SP 2013 API..."),e.SpApi15.getCurrentUser(function(e,o){t.currentUser=e,t.viewModel.currentUser(e),t.debug&&(console.info("This is the SP 2013 API."),console.info("Current user is..."),console.info(t.viewModel.currentUser())),t.nextAsync(!0,"Retrieved your account.")},!0,t.siteUrl)},t.prototype.getListAsync=function(t,o){function i(o,i){if(i)try{var a=$(i),r=a.attr("DisplayName"),s=a.attr("Type"),l=a.attr("StaticName"),d=a.attr("Format"),c=!!a.attr("Required")&&"true"==a.attr("Required").toLowerCase(),u=!!a.attr("ReadOnly")&&"true"==a.attr("ReadOnly").toLowerCase(),p=a.attr("Description"),m=t.viewModel,h=e.Utils.toCamelCase(l);if(h in t.viewModel)return;t.fieldNames.push(h);var f;a.find("> Default").each(function(e,t){var o=$.trim($(t).text());if(s)switch(s.toLowerCase()){case"boolean":o="0"!=o;break;case"number":case"currency":o-=0;break;case"datetime":"[today]"==o&&(o=new Date)}f=o});var v=s&&/^multi/i.test(s)?ko.observableArray([]):ko.observable(f||"Boolean"!=s&&null);v._metadata={koName:h,displayName:r||null,name:l||null,format:d||null,required:c||!1,readOnly:u||!1,description:p||null,type:s};for(var b in v._metadata)v["_"+b]=v._metadata[b];if(n.test(s)){var g=a.attr("FillInChoice");v._isFillInChoice=!!g&&"True"==g;var x=[],y=[];a.find("CHOICE").each(function(e,t){var o=$(t).text();x.push({value:$(t).text(),selected:!1}),y.push(o)}),v._choices=x,v._options=y,v._multiChoice=!!s&&"MultiChoice"==s,v._metadata.choices=x,v._metadata.options=y,v._metadata.multichoice=v._multiChoice}v._metadata.$parent=v,m[h]=v,t.debug&&console.info("Created KO object: "+h+", type: "+s+", default val: "+f)}catch(e){if(t.logError("Failed to setup KO object at SPForm.getListAsync.setupKoVar(): ",e),t.debug)throw e}}void 0===o&&(o=void 0);var n=/choice/i,a=/\b(FolderChildCount|ItemChildCount|MetaInfo|ContentType|Edit|Type|LinkTitleNoMenu|LinkTitle|LinkTitle2|Version|Attachments)\b/;e.SpSoap.getList(t.siteUrl,t.listName,function(o,n){if(n){var r="Failed to retrieve list data. "+n;return t.nextAsync(!1,"Failed to retrieve list data. "+n),void t.logError(r)}!function(o){try{var n=$(o).find("List").first(),r=n.attr("ID");t.listId=r;var s=n.attr("RequireCheckout");t.requireCheckout=!!s&&"true"==s.toLowerCase();var l=n.attr("EnableAttachments");t.enableAttachments=!!l&&"true"==l.toLowerCase(),t.defaultViewUrl=n.attr("DefaultViewUrl"),t.defaultMobileViewUrl=n.attr("MobileDefaultViewUrl");var d=n.attr("RootFolder");t.listItemType=e.Utils.tail(d.split("/")).toString(),$(o).find("Field").filter(function(e,t){return!!$(t).attr("StaticName")&&"TRUE"!=$(t).attr("Hidden")&&!a.test($(t).attr("Name"))}).each(i),t.fieldNames.sort(),t.debug&&(console.info(t.listName+" list ID = "+t.listId),console.info("Field names are..."),console.info(t.fieldNames)),t.nextAsync(!0,"Initialized list settings.")}catch(e){if(t.debug)throw e;var c="Failed to initialize list settings.";t.logError(c+" SPForm.getListAsync.setupList(): ",e),t.nextAsync(!1,c)}}(o)})},t.prototype.initForm=function(o,i){void 0===i&&(i=void 0);try{o.updateStatus("Initializing dynamic form features...",!0,o);o.viewModel;if(e.Utils.indexOf(o.fieldNames,"IsSubmitted")>-1&&(o.allowSave=!0,e.ViewModel.isSubmittedKey="IsSubmitted",o.debug&&console.info("initFormAsync: IsSubmitted key: "+e.ViewModel.isSubmittedKey)),o.viewModel.allowSave(o.allowSave),o.viewModel.allowPrint(o.allowPrint),o.viewModel.allowDelete(o.allowDelete),o.$formAction=$(e.Templates.getFormAction()).appendTo(o.$form),o.enableAttachments&&o.setupAttachments(o),o.enableErrorLog&&e.SpApi.getListItems(o.errorLogListName,function(e,i){i&&(o.enableErrorLog=t.enableErrorLog=!1)},o.errorLogSiteUrl,null,"Title,Error","Modified",1,!1),o.includeNavigationMenu){var n=o.$form.find(".so-nav-menu, [data-so-nav-menu], [so-nav-menu]");n.length>0?n.replaceWith(e.Templates.soNavMenuControl):o.$form.prepend(e.Templates.soNavMenuControl)}if(o.$form.find(".created-info, [data-sp-created-info], [data-so-created-info], [sp-created-info], [so-created-info]").replaceWith(e.Templates.soCreatedModifiedInfoControl),o.includeWorkflowHistory){var a=o.$form.find(".workflow-history, [data-so-workflow-history], [so-workflow-history]");a.length>0?a.replaceWith(e.Templates.soWorkflowHistoryControl):o.$form.append(e.Templates.soWorkflowHistoryControl)}return o.$form.find("[data-new-only]").before("\x3c!-- ko ifnot: !!$root.Id() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-edit-only]").before("\x3c!-- ko if: !!$root.Id() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-author-only]").before("\x3c!-- ko if: !!$root.isAuthor() --\x3e").after("\x3c!-- /ko --\x3e"),o.$form.find("[data-non-authors]").before("\x3c!-- ko ifnot: !!$root.isAuthor() --\x3e").after("\x3c!-- /ko --\x3e"),void o.nextAsync(!0,"Form initialized.")}catch(e){if(o.debug)throw e;return o.logError("Error in SPForm.initFormAsync(): ",e),void o.nextAsync(!1,"Failed to initialize form.")}},t.prototype.getListItemAsync=function(t,o){if(void 0===o&&(o=void 0),t.itemId){t.updateStatus("Retrieving form values...",!0,t);t.viewModel;e.SpApi15.GetListItem(t.listName,t.itemId,t.siteUrl,!1,"AttachmentFiles").done(function(e,o){if(void 0===o&&(o=void 0),o)return/not found/i.test(o+"")&&t.showDialog("The form with ID "+t.itemId+" doesn't exist or it was deleted."),void t.nextAsync(!1,o);t.listItem=e,t.listItemMetadata=e.__metadata,t.bindListItemValues(t),t.nextAsync(!0,"Retrieved form data.")})}else t.nextAsync(!0,"This is a New form.")},t.prototype.implementPermissions=function(e,t){void 0===t&&(t=void 0);try{e.updateStatus("Retrieving your permissions...",!0,e),e.$form.find("[data-sp-groups], [user-groups]").each(function(e,t){var o=$(t).attr("data-sp-groups");o||(o=$(t).attr("user-groups")),$(t).before("\x3c!-- ko if: !!$root.isMember("+o+") --\x3e").after("\x3c!-- /ko --\x3e")}),e.nextAsync(!0,"Retrieved your permissions.")}catch(t){if(e.debug)throw t;e.logError("Error in SPForm.implementPermissionsAsync() ",t),e.nextAsync(!0,"Failed to retrieve your permissions.")}},t.prototype.getHistoryAsync=function(t,o){if(void 0===o&&(o=void 0),t.itemId&&t.includeWorkflowHistory){t.updateStatus("Retrieving workflow history...",!0,t);var i="ListID eq '"+t.listId+"' and PrimaryItemID eq "+t.itemId;e.SpApi.getListItems(t.workflowHistoryListName,function(o,i){if(t.debug&&(console.info("Retrieved workflow history..."),console.info(o.length)),i||!o){var n="The "+t.workflowHistoryListName+' list may be full at <a href="{url}">{url}</a>. Failed to retrieve workflow history in method, getHistoryAsync().'.replace(/\{url\}/g,t.rootUrl+t.siteUrl+"/Lists/"+t.workflowHistoryListName.replace(/\s/g,"%20"));return t.logError(n),void t.nextAsync(!1,"Failed to retrieve workflow history. "+i)}t.viewModel.historyItems([]);for(var a=0;a<o.length;a++)t.viewModel.historyItems().push(new e.HistoryItem(o[a].Description,e.Utils.parseDate(o[a].DateOccurred)));t.viewModel.historyItems.valueHasMutated(),t.nextAsync(!0,"Retrieved workflow history.")},t.siteUrl,i,"Description,DateOccurred","DateOccurred",25,!1)}else t.nextAsync(!0)},t.prototype.bindListItemValues=function(t){void 0===t&&(t=void 0),t=t||this;try{if(!t.itemId)return;var o=t.listItem,i=t.viewModel;t.debug&&console.info("binding values from list item: ",o);var n=/\b(__metadata|ContentTypeID|ContentType|Owshiddenversion|Version|Attachments|AttachmentFiles|Path)\b/;t.itemId=o.Id,i.Id(o.Id);for(var a in t.viewModel)o[a]&&i[a]._type&&!n.test(a)&&(t.debug&&console.info("binding ko value: ",a,o[a]),null!=o[a]&&"DateTime"==i[a]._type?i[a](e.Utils.parseDate(o[a])):"MultiChoice"==i[a]._type?i[a](o[a].results):i[a](o[a]||null));(o.AuthorId||o.Author)&&(isNaN(o.Author)||(o.AuthorId=o.Author),e.SpApi15.GetUserById(t.siteUrl,o.AuthorId).done(function(t){t.Picture||(t.Picture=e.SpApi15.GetGenericPersonPng()),o.CreatedBy=t,i.CreatedBy(o.CreatedBy)})),(o.EditorId||o.Editor)&&(isNaN(o.Editor)||(o.EditorId=o.Editor),e.SpApi15.GetUserById(t.siteUrl,o.EditorId).done(function(t){t.Picture||(t.Picture=e.SpApi15.GetGenericPersonPng()),o.ModifiedBy=t,i.ModifiedBy(o.ModifiedBy)})),i.Created(e.Utils.parseDate(o.Created)),i.Modified(e.Utils.parseDate(o.Modified))}catch(e){if(t.debug)throw e;t.logError("Failed to bind form values in SPForm.bindListItemValues(): ",e)}},t.prototype.deleteListItem=function(t,o,i){if(void 0===o&&(o=void 0),void 0===i&&(i=3e3),confirm("Are you sure you want to delete this form?")){var n=t.parent,a=n.listItem;e.SpApi.deleteListItem(a,function(e,t){t?o&&o(e,t):(n.showDialog("The form was deleted. You'll be redirected in "+i/1e3+" seconds."),o&&o(e),setTimeout(function(){window.location.replace(null!=n.sourceUrl?n.sourceUrl:n.rootUrl)},i))})}},t.prototype.saveListItem=function(t,o,i,n){function a(t,i,a){i.debug&&(console.info("saveListItemCallback(): "),console.info(i.itemId)),i.itemId=a,t.Id(a),null==e.Utils.getIdFromHash()&&null!=i.itemId&&e.Utils.setIdHash(i.itemId),o?(i.showDialog("<p>Your form has been submitted. You will be redirected in "+l/1e3+" seconds.</p>","Form Submission Successful"),n&&n(i.itemId),i.debug?console.warn("DEBUG MODE: Would normally redirect user to confirmation page: "+i.confirmationUrl):setTimeout(function(){window.location.href=null!=i.sourceUrl?i.sourceUrl:i.confirmationUrl},l)):(i.showDialog(d,"The form has been saved.",l),i.getListItemAsync(i),i.includeWorkflowHistory&&setTimeout(function(){i.getHistoryAsync(i)},5e3))}void 0===o&&(o=!1),void 0===i&&(i=void 0),void 0===n&&(n=void 0);var r=t.parent,s=!(null!=r.itemId),l=3e3,d=i||"<p>Your form has been saved.</p>",c={};try{var u=e.Utils.getEditableKoNames(r.$form);if($(u).each(function(e,t){r.pushEditableFieldName(t)}),r.editableFields.sort(),r.debug&&(console.info("Editable fields..."),console.info(r.editableFields)),o=void 0===o||o,r.preSave){var p=r.preSave(r,r.viewModel,o);if(void 0!==p&&!p)return}if(o&&!r.formIsValid(t))return;var m=t[e.ViewModel.isSubmittedKey];void 0===m||null!=m()&&0!=m()||([].push([e.ViewModel.isSubmittedKey,o?1:0]),c[e.ViewModel.isSubmittedKey]=o);$(r.editableFields).each(function(o,i){if("_metadata"in t[i]){var n=t[i](),a=t[i]._name,s=t[i]._type||t[i]._metadata.type;if(s=s?s.toLowerCase():null,r.debug&&console.info("saving: ",a,s),void 0!==n&&i!=e.ViewModel.isSubmittedKey){if("datetime"==s){var l=e.Utils.parseDate(n);l&&(n=l)}else if(null!=n&&"note"==s)n=$("<div>").html(n).html();else if("user"==s)return void(c[a+"Id"]=n?parseInt(n.split(";")[0]):null);c[a]=n}}}),s?e.SpApi15.AddListItem(r.siteUrl,r.listName,r.listItemType,c).done(function(e){a(t,r,e.Id)}):e.SpApi15.UpdateListItem(r.siteUrl,r.listItem.__metadata,c).then(function(e){a(t,r,r.itemId)})}catch(e){if(r.debug)throw e;r.logError("Error in SpForm.saveListItem(): ",e)}},t.prototype.finalize=function(e){try{e.setupNavigation(e),e.setupDatePickers(e),e.nextAsync(!0,"Finalized form controls.")}catch(t){if(e.debug)throw t;e.logError("Error in SpForm.finalize(): ",t),e.nextAsync(!1,"Failed to finalize form controls.")}},t.prototype.deleteAttachment=function(t,o){var i=e.ViewModel.parent,n=i.viewModel;i.debug&&console.info("deleting file: ",t),confirm("Are you sure you want to delete "+t.FileName+"? This can't be undone.")&&e.SpApi15.DeleteAttachment(i.siteUrl,t).done(function(e,o,a){i.debug&&console.info("deleted file: ",t);var r=n.attachments;r.remove(t),r.valueHasMutated()}).fail(function(e,t,o){alert("Failed to delete attachment: "+t+": "+o)})},t.prototype.getAttachments=function(t,o){if(void 0===t&&(t=void 0),void 0===o&&(o=void 0),(t=t||this).listItem&&t.enableAttachments&&t.listItem.Attachments){var i=[],n=t.listItem.__metadata.uri+"/AttachmentFiles";e.SpApi15.Get(n,!1).done(function(e,n,a){try{t.viewModel.attachments(e.results),t.viewModel.attachments.valueHasMutated(),o&&o(i)}catch(e){if(t.debug)throw e;t.showDialog("Failed to retrieve attachments in SpForm.getAttachments(): ",e)}})}else o&&o()},t.prototype.log=function(e){this.debug&&console.log(e)},t.prototype.updateStatus=function(e,t,o){void 0===t&&(t=!0);var i=o;i.$formStatus.html(e).css("color",t?"#ff0":"$f00").show(),setTimeout(function(){i.$formStatus.hide()},2e3)},t.prototype.showDialog=function(e,t,o){void 0===t&&(t=void 0),void 0===o&&(o=void 0);var i=this;t=t||"Form Dialog",e=null==e.toString().match(/<\w>\w*/)?"<p>"+e+"</p>":e,i.$dialog.html(e).dialog("open"),o&&setTimeout(function(){i.$dialog.dialog("close")},o)},t.prototype.formIsValid=function(t,o){void 0===o&&(o=!1);var i=t.parent,n=[],a=0,r=0,s=[];try{return i.$form.find(".required, [required]").each(function(o,r){var s=e.Utils.observableNameFromControl(r,i.viewModel);if(s&&t[s]){var l=t[s]();if(null==l||0==$.trim(l+"").length){var d,c=$("label[for='"+s+"']");c&&(d=c.html()),d||(d=$(r).closest(".form-group").find("label:first").html()),d||(d=t[s]._displayName),d||$(r).parent().first().html(),e.Utils.indexOf(n,d)<0&&(n.push(d),a++)}}}),i.$form.find(".invalid").each(function(e,t){$(t).parent();s.push($(parent).first().html()),r++}),r>0&&n.push('<p class="warning">There are validation errors with the following fields. Please correct before saving.</p><p style="color:#f00;">'+s.join("<br />")+"</p>"),i.enableAttachments&&i.requireAttachments&&0==t.attachments().length&&(a++,n.push(i.attachmentMessage)),!(a>0)||(i.showDialog('<p>The following fields are required or invalid:</p><div class="error">'+n.join("<br/>")+"</div>"),!1)}catch(e){if(i.debug)throw e;return i.logError("Form validation error at SPForm.formIsValid(): ",e),!1}},t.prototype.getPersonById=function(o,i){var n=this;o&&e.SpApi.getPersonById(o,function(o,a){if(a){var r="Error in SPForm.getPersonById: "+a;return e.Utils.logError(r,t.errorLogListName),void(n.debug&&console.warn(r))}var s=o.Id+";#"+o.Name.replace(/^i\:0\#\.w\|/,"");i(s),n.debug&&console.warn("Retrieved person by ID... "+s)})},t.prototype.pushEditableFieldName=function(t){return!t||e.Utils.indexOf(this.editableFields,t)>-1||null!=t.match(/^(_|\$)/)||e.Utils.indexOf(this.fieldNames,t)<0||this.viewModel[t]._readOnly?-1:this.editableFields.push(t)},t.prototype.logError=function(t,o,i){void 0===o&&(o=void 0),void 0===i&&(i=void 0),i=i||this;var n=[t];o&&n.push(o+""),n=n.length>0?n.join("; "):n.join(""),i.enableErrorLog&&(e.Utils.logError(n,i.errorLogListName,i.errorLogSiteUrl,i.debug),i.showDialog("<p>An error has occurred and the web administrator has been notified.</p><pre>"+n+"</pre>"))},t.prototype.setupAttachments=function(e){void 0===e&&(e=void 0);(e=e||this).viewModel;if(!e.enableAttachments)return 0;try{e.$form.find(".attachments, [data-sp-attachments]").each(function(e,t){$(t).replaceWith('<so-attachments params="val: attachments"></so-attachments>')}),e.debug&&console.info("Attachments are enabled.")}catch(t){if(e.debug)throw t;e.logError("Error in SPForm.setupAttachments(): ",t)}return 0},t.prototype.setupNavigation=function(t){void 0===t&&(t=void 0);var o=0;if(!(t=t||this).includeNavigationMenu)return o;try{if(0==t.$form.find(".nav-section").length)return o;t.$form.find(".nav-section:visible").each(function(i,n){var a=$(n),r=a.find("> h4");if(0!=r.length){var s=r.html(),l=e.Utils.toCamelCase(s)+"Nav";a.before('<div style="height:1px;" id="'+l+'">&nbsp;</div>'),t.viewModel.navMenuItems().push({title:s,anchorName:l}),o++}}),t.viewModel.navMenuItems.valueHasMutated(),t.$form.append('<a href="#TOP" class="back-to-top"><span class="glyphicon glyphicon-chevron-up"></span></a>'),$("body").delegate("a[href*=#]:not([href=#])","click",function(){if(window.location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if((e=e.length?e:$("[name="+this.hash.slice(1)+"]")).length)return $("html,body").animate({scrollTop:e.offset().top-50},1e3),!1}})}catch(e){if(t.debug)throw e;t.logError("Error in SpForm.setupNavigation(): ",e)}return o},t.prototype.setupDatePickers=function(e){void 0===e&&(e=void 0);var t=(e=e||this).$form.find("input.datepicker").datepicker();return e.debug&&console.info("Bound "+t.length+" jQueryUI datepickers."),t.length},t.prototype.currentUserIsMemberOfGroups=function(t){var o=[];if(e.Utils.isString(t))o=null!=t.match(/\,/)?t.split(","):[t];else{if(t.constructor!==Array)return!1;o=t}for(var i=0;i<o.length;i++){var n=o[i];n=null!=n.match(/\;#/)?n.split(";")[0]:n,n=e.Utils.trim(n);for(var a=0;a<this.currentUser.groups.length;a++){var r=this.currentUser.groups[a];if(n==r.name||parseInt(n)==r.id)return!0}}return!1},t.DEBUG=!1,t}();e.SPForm=t}(Shockout||(Shockout={})),window.so=window.so||Shockout;!function(e){var t=function(){function e(t){this.Id=ko.observable(null),this.Created=ko.observable(null),this.CreatedBy=ko.observable(null),this.Modified=ko.observable(null),this.ModifiedBy=ko.observable(null),this.allowSave=ko.observable(!1),this.allowPrint=ko.observable(!1),this.allowDelete=ko.observable(!1),this.attachments=ko.observableArray(),this.historyItems=ko.observableArray(),this.showUserProfiles=ko.observable(!1),this.navMenuItems=ko.observableArray();var o=this;this.parent=t,e.parent=t,this.isValid=ko.pureComputed(function(){return o.parent.formIsValid(o)}),this.deleteAttachment=t.deleteAttachment,this.getAttachments=t.getAttachments,this.currentUser=ko.observable(t.getCurrentUser()),this.attachments.getViewModel=function(){return o},this.attachments.getSpForm=function(){return o.parent},this.isMember=ko.pureComputed({read:function(){return!1},write:function(e){return o.parent.currentUserIsMemberOfGroups(e)},owner:this})}return e.prototype.isAuthor=function(){return!this.CreatedBy()||this.currentUser().id==this.CreatedBy().Id},e.prototype.deleteItem=function(){this.parent.deleteListItem(this)},e.prototype.cancel=function(){var e=this.parent.getSourceUrl();window.location.href=e||this.parent.getRootUrl()},e.prototype.print=function(){window.print()},e.prototype.save=function(e,t){this.parent.saveListItem(e,!1)},e.prototype.submit=function(e,t){this.parent.saveListItem(e,!0)},e}();e.ViewModel=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.bindKoHandlers=function(){!function(t){t.bindingHandlers.spHtmlEditor={init:function(t,o,i,n){function a(){n[r]($(this).html())}var r=e.Utils.observableNameFromControl(t);$(t).blur(a).change(a).keydown(a)},update:function(e,o,i,n){var a=t.utils.unwrapObservable(o())||"";e.innerHTML!==a&&(e.innerHTML=a)}},t.bindingHandlers.spPerson={init:function(o,i,n,a){function r(t,o){if(""==$.trim($(t).val()))return o(null),void $(t).removeClass("valid").removeClass("invalid");e.Utils.validateSpPerson(o())?($(t).val(o().split("#")[1]),$(t).addClass("valid").removeClass("invalid")):$(t).removeClass("valid").addClass("invalid")}try{if("input"!=o.tagName.toLowerCase()||"hidden"==$(o).attr("type"))return;a.$data;var s=i(),l=(t.unwrap(s),$(o).addClass("people-picker-control").attr("placeholder","Employee Account Name")),d=($(o).parent(),$("<div>",{class:"sp-validation person"}));l.after(d);var c=$("<div>",{class:"no-print",html:"<em>Enter the employee name. The auto-suggest menu will appear below the field. Select the account name.</em>"});d.after(c);var u=$("<button>",{html:e.Templates.personIcon,class:e.Templates.buttonDefault,title:"Validate the employee account name."}).on("click",function(){return""==$.trim(l.val())?(l.removeClass("invalid").removeClass("valid"),!1):(e.Utils.validateSpPerson(s())?(d.text("Valid").removeClass("error"),l.removeClass("invalid").addClass("valid").show()):(d.text("Invalid").addClass("error").show(),l.addClass("invalid").removeClass("valid")),!1)}).insertAfter(l),p=($("<button>",{class:e.Templates.resetButton,html:"Reset"}).on("click",function(){return s(null),!1}).insertAfter(u),{source:e.SPForm.searchPrincipals?function(t,o){e.SpSoap.searchPrincipals(t.term,function(t){var i=$.map(t,function(e){var t=e.AccountName;return t.indexOf("|")>-1&&(t=t.split("|")[1]),{label:e.DisplayName+" ("+e.Email+")",value:e.UserInfoID+";#"+t}});$.isFunction(e.peopleFilter)&&(i=e.peopleFilter(i)),o(i)},10,"User")}:function(t,o){e.SpApi.searchUsers(t.term,function(t){for(var i=[],n=0;n<t.length;n++){var a=t[n],r=a.Account;r.indexOf("|")>-1&&(r=r.split("|")[1]),i.push({label:a.Name+" ("+a.WorkEmail+")",value:a.Id+";#"+r})}$.isFunction(e.peopleFilter)&&(i=e.peopleFilter(i)),o(i)})},minLength:3,select:function(e,t){s(t.item.value)}});$(o).autocomplete(p),$(o).on("focus",function(){$(this).removeClass("valid")}).on("blur",function(){r(this,s)}).on("mouseout",function(){r(this,s)})}catch(t){e.SPForm.DEBUG&&(console.info("Error in Knockout handler spPerson init()"),console.info(t))}},update:function(o,i,n,a){try{a.$data;var r=i(),s=t.unwrap(r),l="";e.Utils.validateSpPerson(s)&&(l=s.indexOf("|")>-1?s.split("|")[1]:s.split("#")[1],$(o).addClass("valid")),"value"in o?$(o).val(l):$(o).text(l)}catch(t){e.SPForm.DEBUG&&(console.info("Error in Knockout handler spPerson update()"),console.info(t))}}},t.bindingHandlers.spMoney={init:function(e,o,i,n,a){function r(){var e=this.value.toString().replace(/[^\d\.\-]/g,"");s(e=""==e?null:e-0)}if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){a.$data;var s=o();t.unwrap(s),$(e).on("blur",r).on("change",r)}},update:function(o,i,n,a,r){r.$data;var s=i(),l=t.unwrap(s);null!=l?l<0?$(o).addClass("negative"):$(o).removeClass("negative"):l=0;var d=e.Utils.formatMoney(l);e.Utils.updateKoField(o,d)}},t.bindingHandlers.spDecimal={init:function(e,o,i,n,a){function r(){var e=this.value.toString().replace(/[^\d\-\.]/g,"");s(e=""==e?null:e-0)}if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){a.$data;var s=o();t.unwrap(s),$(e).on("blur",r).on("change",r)}},update:function(o,i,n,a,r){r.$data;var s=i(),l=t.unwrap(s),d=n.get("precision")||2,c=e.Utils.toFixed(l,d);null!=l?l<0?$(o).addClass("negative"):$(o).removeClass("negative"):l=0,e.Utils.updateKoField(o,c)}},t.bindingHandlers.spNumber={init:function(e,o,i,n,a){function r(){var e=this.value.toString().replace(/[^\d\-]/g,"");s(e=""==e?null:e-0)}if("input"==e.tagName.toLowerCase()&&"hidden"!=$(e).attr("type")){a.$data;var s=o();t.unwrap(s),$(e).on("blur",r).on("change",r)}},update:function(o,i,n,a,r){r.$data;var s=i(),l=t.unwrap(s);l=(l=null==l?0:l).constructor==String?l=l.replace(/\D/g)-0:l,e.Utils.updateKoField(o,l),s.constructor==Function&&s(l)}},t.bindingHandlers.spDate={after:["attr"],init:function(t,o,i,n,a){function r(){s(e.Utils.parseDate(this.value))}var s=o();"input"==t.tagName.toLowerCase()&&"hidden"!=$(t).attr("type")&&($(t).css("display","inline-block").addClass("datepicker med").attr("placeholder","MM/DD/YYYY").on("blur",r).on("change",r).after(e.Templates.calendarIcon),$(t).datepicker({changeMonth:!0,changeYear:!0}))},update:function(o,i,n,a,r){var s=i(),l=e.Utils.parseDate(t.unwrap(s)),d="";l&&null!=l&&(d=e.Utils.dateToLocaleString(l)),"value"in o?$(o).val(d):$(o).text(d)}},t.bindingHandlers.spDateTime={after:["attr"],init:function(t,o,i,n,a){if("input"==t.tagName.toLowerCase()&&"hidden"!=$(t).attr("type"))try{var r=o(),s=new e.DateTimeModel(t,r);t.$$model=s}catch(t){if(e.SPForm.DEBUG)throw console.warn("Error in Knockout handler spDateTime init()..."),t}},update:function(o,i,n,a,r){try{var s=i();if(e.Utils.parseDate(t.unwrap(s)),"input"==o.tagName.toLowerCase()){var l=o.$$model;l&&l.setDisplayValue(s)}else $(o).text(e.DateTimeModel.toString(s))}catch(t){if(e.SPForm.DEBUG)throw console.warn("Error in Knockout handler spDateTime update()..."),t}}}}(ko)},t}();e.KoHandlers=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.registerKoComponents=function(){function t(e){if(!e)throw"params is undefined in so-static-field";var t=e.val||e.modelValue;if(!t)throw"Parameter `val` or `modelValue` for so-static-field is required!";this.modelValue=t,this.id=e.id||t._koName,this.label=e.label||t._displayName,this.description=e.description||t._description;var o=parseInt(e.labelColWidth||3),i=parseInt(e.fieldColWidth||12-(o-0));this.labelColWidth="col-sm-"+o,this.fieldColWidth="col-sm-"+i}function o(e){if(!e)throw"params is undefined in soFieldModel";var t=e.val||e.modelValue;if(!t)throw"Parameter `val` or `modelValue` for so-text-field is required!";this.modelValue=t,this.id=e.id||t._koName,this.name=e.name||t._koName||e.id,this.label=e.label=""==e.label?void 0:e.label||t._displayName,this.title=e.title,this.caption=e.caption,this.maxlength=e.maxlength||255,this.placeholder=e.placeholder||e.label||t._displayName,this.description=void 0!==e.description?null==e.description?void 0:e.description:t._description,this.valueUpdate=e.valueUpdate,this.editable=!!t._koName,this.koName=t._koName,this.options=e.options||t._options,this.required="function"==typeof e.required?e.required:ko.observable(!!e.required||!1),this.inline=e.inline||!1,this.multiline=e.multiline||!1;var o=parseInt(e.labelColWidth||3),i=parseInt(e.fieldColWidth||12-(o-0));this.labelColWidth="col-sm-"+o,this.fieldColWidth="col-sm-"+i,this.readOnly="function"==typeof e.readOnly?e.readOnly:ko.observable(!!e.readOnly||!1)}function i(t){function o(t){d=[];Array.prototype.slice.call(t,0).map(function(t,o){d.push(function(){!function(t){c.debug&&(console.info("uploading file..."),console.info(t));a.attachments()||a.attachments([]);var o=t.name.replace(/[^a-zA-Z0-9_\-\.]/g,""),i=/\.\w{2,4}$/.exec(o)[0],n=o.replace(new RegExp(i+"$"),"");if(!new RegExp("^(\\.|)("+p.join("|")+")$","i").test(i))return void a.errorMsg("Only files with the extensions: "+p.join(", ")+" are allowed.");for(var r=0;r<a.attachments().length;r++)if(new RegExp(o,"i").test(a.attachments()[r].Name)){o=n+"-1"+i;break}var l=new e.FileUpload(o,t.size);a.fileUploads().push(l),a.fileUploads.valueHasMutated(),(s=new FileReader).onerror=function(e){var t=e,o=l.className();switch(l.className(o.replace("-success","-danger")),t.target.error.code){case t.target.error.NOT_FOUND_ERR:a.errorMsg="File Not Found!";break;case t.target.error.NOT_READABLE_ERR:a.errorMsg="File is not readable.";break;case t.target.error.ABORT_ERR:break;default:a.errorMsg="An error occurred reading this file."}},s.onprogress=function(e){!function(e,t){if(e.lengthComputable){var o=Math.round(e.loaded/e.total*100);o<100&&t.progress(o)}}(e,l)},s.onabort=function(e){a.errorMsg("File read cancelled")},s.onloadstart=function(e){l.progress(0)},s.onload=function(t){var i=t;l.progress(100),e.SpSoap.addAttachment(i.target.result,o,c.listName,c.viewModel.Id(),c.siteUrl,function(){c.getAttachments(c),setTimeout(function(){a.fileUploads.remove(l)},1e3)})},s.onloadend=function(e){},s.readAsDataURL(t)}(t)})}),l=new e.Cafe(d),null==u.Id()?c.saveListItem(u,!1,void 0,function(e){null==u.Id()&&e&&e.toFixed&&u.Id(e),setTimeout(function(){l.next(!0)},1e3)}):l.next(!0)}function i(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()}var a=this,r=window;if(this.errorMsg=ko.observable(null),!t)throw this.errorMsg("`params` is undefined in component so-attachments"),this.errorMsg();if(!t.val)throw this.errorMsg("Parameter `val` for component so-attachments is required!"),this.errorMsg();var s,l,d,c=t.val.getSpForm(),u=c.getViewModel(),p=t.allowedExtensions||c.allowedExtensions;this.attachments=t.val,this.label=t.label||"Attach Files",this.drop=t.drop||!0,this.dropLabel=t.dropLabel||"...or Drag and Drop Files Here",this.className=t.className||"btn btn-primary",this.title=t.title||"Attachments",this.description=t.description,this.readOnly="function"==typeof t.readOnly?t.readOnly:ko.observable(t.readOnly||!1),this.length=ko.pureComputed(function(){var e=a.attachments();return e?e.length:0}),this.fileUploads=ko.observableArray(),this.hasFileReader=ko.observable(r.File&&r.FileReader&&r.FileList&&r.Blob),this.hasFileReader()||this.errorMsg("This browser does not support the FileReader class required for uplaoding files. You may be using IE 9 or another unsupported browser."),this.id=t.id||"so_fileUploader_"+n(),this.deleteAttachment=function(t,o){confirm("Are you sure you want to delete "+t.FileName+"? This can't be undone.")&&e.SpApi15.DeleteAttachment(c.siteUrl,t).done(function(e,o,i){a.debug&&console.info("deleted file: ",t);var n=u.attachments;n.remove(t),n.valueHasMutated()}).fail(function(e,t,o){alert("Failed to delete attachment: "+t+": "+o)})},this.fileHandler=function(e){o(document.getElementById(a.id).files)},this.onSelect=function(e){i(e),document.getElementById(a.id).click()},this.onDrop=function(e,t){i(t),c.debug&&(console.info("dropped files over dropzone, arguments are..."),console.info(arguments));var n=(t.originalEvent||t).dataTransfer.files;if(!n)return console.warn("Error in so-attachments - event.dataTransfer.files is "+typeof n),!1;o(n)},this.onDragenter=i,this.onDragover=i,c.enableAttachments||(this.errorMsg("Attachments are disabled for this form or SharePoint list."),this.readOnly(!0))}var n=function(){var e=0;return function(){return e++}}();ko.components.register("so-text-field",{viewModel:o,template:e.Templates.soTextField}),ko.components.register("so-html-field",{viewModel:o,template:e.Templates.soHtmlFieldTemplate}),ko.components.register("so-person-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spPerson: modelValue')}),ko.components.register("so-date-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDate: modelValue')}),ko.components.register("so-datetime-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDateTime: modelValue')}),ko.components.register("so-money-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spMoney: modelValue')}),ko.components.register("so-number-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spNumber: modelValue')}),ko.components.register("so-decimal-field",{viewModel:o,template:e.Templates.soTextField.replace(/data-bind="(value|text): modelValue/g,'data-bind="spDecimal: modelValue')}),ko.components.register("so-checkbox-field",{viewModel:o,template:e.Templates.soCheckboxField}),ko.components.register("so-select-field",{viewModel:o,template:e.Templates.soSelectField}),ko.components.register("so-checkbox-group",{viewModel:o,template:e.Templates.soCheckboxGroup}),ko.components.register("so-radio-group",{viewModel:o,template:e.Templates.soRadioGroup}),ko.components.register("so-usermulti-group",{viewModel:function(e){if(!e)throw"params is undefined in soFieldModel";var t=this,o=e.val||e.modelValue;if(!o)throw"Parameter `val` or `modelValue` for so-text-field is required!";this.modelValue=o,this.placeholder="",this.id=e.id||o._koName,this.name=e.name||o._koName||e.id,this.label=e.label||o._displayName,this.title=e.title,this.required=e.required,this.description=e.description||o._description,this.editable=!!o._koName,this.koName=o._koName,this.person=ko.observable(null),this.readOnly="function"==typeof e.readOnly?e.readOnly:ko.observable(!!e.readOnly||!1),this.addPerson=function(e,o){null==t.modelValue()&&t.modelValue([]);var i=!1;return ko.utils.arrayForEach(t.modelValue(),function(e){e==t.person()&&(i=!0)}),i?this.shake(o):(t.modelValue().push(t.person()),t.modelValue.valueHasMutated(),t.person(null)),!1},this.removePerson=function(e,o){try{t.modelValue.remove(e)}catch(o){t.modelValue().indexOf(e)>-1&&(t.modelValue().splice(t.modelValue().indexOf(e),1),t.modelValue.valueHasMutated())}return!1},this.showRequiredText=ko.pureComputed(function(){return!!t.required&&(!t.modelValue()||t.modelValue().length<1)}),this.shake=function(e){var t=$("button[id="+e.currentTarget.id+"]");t.css("position","relative");for(var o=1;o<=3;o++)t.removeClass("btn-success").addClass("btn-danger").animate({left:-5},200/3/4).animate({left:5},200/3/2).animate({left:0},200/3/4),setTimeout(function(){t.removeClass("btn-danger btn-warning").addClass("btn-success")},1e3)}},template:e.Templates.soUsermultiField}),ko.components.register("so-static-field",{viewModel:t,template:e.Templates.soStaticField}),ko.components.register("so-static-person",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spPerson: modelValue')}),ko.components.register("so-static-date",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDate: modelValue')}),ko.components.register("so-static-datetime",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDateTime: modelValue')}),ko.components.register("so-static-money",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spMoney: modelValue')}),ko.components.register("so-static-number",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spNumber: modelValue')}),ko.components.register("so-static-decimal",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="spDecimal: modelValue')}),ko.components.register("so-static-html",{viewModel:t,template:e.Templates.soStaticField.replace(/data-bind="text: modelValue/g,'data-bind="html: modelValue')}),ko.components.register("so-attachments",{viewModel:i,template:e.Templates.soAttachments}),ko.components.register("so-created-modified-info",{viewModel:function(e){this.CreatedBy=e.createdBy,this.ModifiedBy=e.modifiedBy,this.profiles=ko.observableArray([{header:"Created By",profile:this.CreatedBy},{header:"Modified By",profile:this.ModifiedBy}]),this.Created=e.created,this.Modified=e.modified,this.showUserProfiles=e.showUserProfiles},template:e.Templates.soCreatedModifiedInfo}),ko.components.register("so-nav-menu",{viewModel:function(e){this.navMenuItems=e.val,this.title=e.title||"Navigation"},template:e.Templates.soNavMenu}),ko.components.register("so-workflow-history",{viewModel:function(e){this.historyItems=e.val||e.historyItems},template:e.Templates.soWorkflowHistory})},t}();e.KoComponents=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.peopleSearch=function(e,o,i){void 0===i&&(i=10);var n="startswith(Name,'{0}')".replace(/\{0\}/g,e);t.getListItems("UserInformationList",function(e,t){t?o(null,t):o(e,t)},"/",n,null,"Name",10,!0)},t.searchUsers=function(e,o,i,n){void 0===i&&(i="Id,Account,Name,WorkEmail"),void 0===n&&(n=10);t.executeRestRequest("/_vti_bin/listdata.svc/UserInformationList?\n            $filter=startswith(WorkEmail, '"+e+"') or startswith(Name, '"+e+"') or startswith(LastName, '"+e+"') and ContentType eq 'Person'\n            &$orderby=Name\n            &$top="+n,function(e,t){t?o(e,t):e&&o(e.d?e.d:e)},!0,"GET")},t.getPersonById=function(e,o){if(!isNaN(parseInt(e+""))){t.executeRestRequest("/_vti_bin/listdata.svc/UserInformationList("+e+")",function(e,t){t?o(e,t):e&&o(e.d?e.d:e)},!0,"GET")}},t.executeRestRequest=function(e,t,o,i){void 0===o&&(o=!1),void 0===i&&(i="GET");var n=$.ajax({url:e,type:i,cache:o,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});n.done(function(e,o,i){t(e)}),n.fail(function(e,o,i){if(o&&404==parseInt(o))var n=o+". The data may have been deleted by another user.";else n=o+" "+i;t(null,n)})},t.getListItem=function(o,i,n,a,r,s){void 0===a&&(a="/"),void 0===r&&(r=!1),void 0===s&&(s=null);var l=(a=e.Utils.formatSubsiteUrl(a))+"_vti_bin/listdata.svc/"+e.Utils.toCamelCase(o)+"("+i+")?$expand=CreatedBy,ModifiedBy"+(s?","+s:"");t.executeRestRequest(l,function(e,t){t?n(e,t):e&&n(e.d?e.d:e)},r,"GET")},t.getListItems=function(o,i,n,a,r,s,l,d){void 0===n&&(n="/"),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=10),void 0===d&&(d=!1);var c=[(n=e.Utils.formatSubsiteUrl(n))+"_vti_bin/listdata.svc/"+e.Utils.toCamelCase(o)];a&&c.push("$filter="+a),r&&c.push("$select="+r),s&&c.push("$orderby="+s),c.push("$top="+l),t.executeRestRequest(c.join("&").replace(/\&/,"?"),function(e,t){var o=null;(e=e&&"d"in e?e.d:e)&&(o="results"in e?e.results:e),i(o,t)},d,"GET")},t.insertListItem=function(e,t,o){void 0===o&&(o=void 0);var i=$.ajax({url:e,type:"POST",processData:!1,contentType:"application/json",data:o?JSON.stringify(o):null,headers:{Accept:"application/json;odata=verbose"}});i.done(function(e,o,i){t(e)}),i.fail(function(e,o,i){t(null,o+": "+i)})},t.updateListItem=function(e,t,o){void 0===o&&(o=void 0);var i=$.ajax({url:e.__metadata.uri,type:"POST",processData:!1,contentType:"application/json",data:o?JSON.stringify(o):null,beforeSend:function(t){t.setRequestHeader("X-HTTP-Method","MERGE"),t.setRequestHeader("If-Match",e.__metadata.etag)}});i.done(function(e,o,i){t(e)}),i.fail(function(e,o,i){t(null,o+": "+i)})},t.deleteListItem=function(e,t){var o=$.ajax({url:e.__metadata.uri,type:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","If-Match":e.__metadata.etag}});o.done(function(e,o,i){t(e)}),o.fail(function(e,o,i){t(null,i)})},t.deleteAttachment=function(e,t){void 0===t&&(t=void 0);return $.ajax({url:e.__metadata.uri,type:"POST",dataType:"json",contentType:"application/json",headers:{Accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE"},success:function(e,o,i){t&&t({data:e,status:o,jqXhr:i})},error:function(e,o,i){t&&t({status:o,jqXhr:e,error:i}),console.warn(i)}})},t}();e.SpApi=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.getCurrentUser=function(t,o,i){void 0===o&&(o=!0),void 0===i&&(i="");var n=e.Utils.formatSubsiteUrl(i),a=$.ajax({url:n+"_api/Web/CurrentUser"+(o?"?$expand=Groups":""),type:"GET",cache:!0,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});return a.done(function(e,i,n){var a=e.d,r=a.LoginName.replace(/^i\:0\#\.w\|/,""),s={account:a.Id+";#"+a.Title,department:null,email:a.Email,groups:[],id:a.Id,jobtitle:null,login:r,title:a.Title};if(o){var l=e.d.Groups;$(l.results).each(function(e,t){s.groups.push({id:t.Id,name:t.Title})})}t&&t(s)}),a.fail(function(e,o,i){t&&t(null,e.status)}),a},t.getUsersGroups=function(t,o,i){void 0===o&&(o=void 0),void 0===i&&(i="");var n=e.Utils.formatSubsiteUrl(i)+"_api/Web/GetUserById("+t+")/Groups",a=$.ajax({url:n,type:"GET",cache:!0,dataType:"json",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json;odata=verbose"}});return a.done(function(e,t,i){for(var n=[],a=0;a<e.d.results.length;a++){var r=e.d.results[a];n.push({id:r.Id,name:r.Title})}o&&o(n)}),a.fail(function(e,t,i){o&&o(null,i)}),a},t.SendEmail=function(o,i,n,a,r){var s=e.Utils.formatSubsiteUrl(o)+"_api/SP.Utilities.Utility.SendEmail";return t.Post(o,s,{properties:{__metadata:{type:"SP.Utilities.EmailProperties"},From:i,To:{results:[n]},Body:a,Subject:r}})},t.Post=function(e,o,i,n){void 0===n&&(n=void 0);var a=$.Deferred(),r=i?JSON.stringify(i):null;return t.GetFormDigest(e).then(function(e){var t={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":e.d.GetContextWebInformation.FormDigestValue,"X-HTTP-Method":"POST"};if(n)for(var i in n)t[i]=n[i];$.ajax({contentType:"application/json;odata=verbose",url:o,type:"POST",data:r,headers:t,success:function(e,t,o){e?a.resolve(e.d||e):a.resolve({status:t,jqXhr:o})},error:function(e,t,o){a.reject({jqXhr:e,status:t,error:o}),console.warn(o)}})}),a.promise()},t.Get=function(e,t){void 0===t&&(t=!1);var o=$.Deferred(),i=$.ajax({url:e,type:"GET",cache:t,dataType:"json",contentType:"application/json; charset=utf-8",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"}});return i.done(function(e,t,i){e?o.resolve(e.d||e):o.resolve({status:t,jqXhr:i})}),i.fail(function(e,t,i){if(t&&404==parseInt(t))var n=t+". The data may have been deleted by another user.";else n=t+" "+i;o.reject(n)}),o.promise()},t.GetListItem=function(o,i,n,a,r){void 0===n&&(n="/"),void 0===a&&(a=!1),void 0===r&&(r=void 0);var s=e.Utils.formatSubsiteUrl(n)+"_api/web/lists/GetByTitle('"+o+"')/items("+i+")"+(r?"?$expand="+r:"");return t.Get(s,a)},t.GetFormDigest=function(t){var o={url:e.Utils.formatSubsiteUrl(t)+"_api/contextinfo",method:"POST",headers:{Accept:"application/json;odata=verbose"}};return $.ajax(o)},t.AddListItem=function(o,i,n,a){var r=e.Utils.formatSubsiteUrl(o)+"_api/web/lists/GetByTitle('"+i+"')/items",s={__metadata:{type:function(e){var t=e.replace(/\s/g,"_x0020_"),o="SP.Data."+t+"ListItem";return new RegExp(o).test(t)?t:o}(n)}};for(var l in a){var d=a[l];null==d||void 0==d?s[l]=null:d.constructor===Array?s[l]=function(e){return{__metadata:{type:"Collection(Edm.String)"},results:e}}(d):s[l]=d}return t.Post(o,r,s)},t.UpdateListItem=function(e,o,i){var n=o.uri,a=$.Deferred(),r={__metadata:{type:o.type}};for(var s in i){var l=i[s];null==l||void 0==l?r[s]=null:l.constructor===Array?r[s]=function(e){return{__metadata:{type:"Collection(Edm.String)"},results:e}}(l):r[s]=l}var d=JSON.stringify(r);return t.GetFormDigest(e).then(function(e){var t={Accept:"application/json;odata=verbose","X-RequestDigest":e.d.GetContextWebInformation.FormDigestValue,"X-HTTP-Method":"MERGE","If-Match":o.etag};$.ajax({contentType:"application/json;odata=verbose",url:n,type:"POST",data:d,headers:t,success:function(e,t,o){e?a.resolve(e.d||e):a.resolve({success:!0})},error:function(e,t,o){a.reject({xhr:e,status:t,error:o}),console.warn(o)}})}),a.promise()},t.GetUserById=function(o,i){var n=e.Utils.formatSubsiteUrl(o)+"_vti_bin/ListData.svc/UserInformationList("+i+")";return t.Get(n,!1)},t.DeleteAttachment=function(e,o,i){void 0===i&&(i=void 0);var n=$.Deferred();return t.GetFormDigest(e).then(function(e){var t={Accept:"application/json;odata=verbose","X-RequestDigest":e.d.GetContextWebInformation.FormDigestValue,"X-HTTP-Method":"DELETE"};$.ajax({contentType:"application/json;odata=verbose",url:o.__metadata.uri,type:"POST",headers:t,success:function(e,t,o){e?n.resolve(e.d||e):n.resolve({success:!0})},error:function(e,t,o){n.reject({xhr:e,status:t,error:o}),console.warn(o)}})}),n.promise()},t.GetGenericPersonPng=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHkAAAB4CAYAAADWpl3sAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAkmSURBVHhe7Z33bxNLEMc3oXcIvTeBaEIEJJqQQIi/ml8AAYpoEj0gmui995r3PivPk19EbOf2bm/Gno90SuLYvvV8d8ru3a77hoaGRp4+fRomTJgQnO7i9+/fYenSpaG/8bfTxbjIPYCL3AO4yD2Ai9wDuMg9gIvcA7jIPYCL3AO4yD2Ai9wDuMg9gIvcA3SdyCMjI+HPnz/xCszPnz/Djx8/wvfv38O3b9/iwe889uvXr/gcnstrupmuuNSISCIux7Rp08LMmTPDwMBAmD17dpg8eXKYPn16fO6nT5+iyO/evQtv374NX758ieL39/dHG/T19cXndQNyqdG0yCIuH2bSpEnxA61ZsybMmzcvTJw4sfGs1uDRL168CPfv3w/Pnz+P78Vru0Fs8yIjLgLhpevWrQsbN26MQqeAV9+8eTMKTkSw7tmmRZawvHr16rBt27YwZcqUxn/KgZB+8eLF8OzZs+jVhHKLiMimWi/ei+H37t0bdu3aVbrAQD4/cOBAGBwc/C8dWMaMyCLwnDlzwuHDh8OyZcsa/6mO9evXh4MHD8aOxLmtYkJkEXjBggXh0KFD/1XKOaBCR2i826rQJkTGuPPnz48htI7aYcaMGfHcdC6LoVu9yBgVI+/bt6/W4hCB9+zZE9tA0WcJ1SLLMGb37t2VFFjjhfH3jh07YrtIIVZQK7JUtZs2bYp5UQurVq2KEy6kECtCqxUZgcnDTHJog7E5KcRK2FYpMh7CTBPG1AizbJs3b47ttODNKkXGixkHM2TSCrNtc+fONeHN6kQWL96wYUPjEb2QSix4szqR8eKFCxeqKrbGgnlhJklc5HEgXkH1agGGdytWrIgdU7PQ6kTmgv+iRYsaj+iH2qHTa9d1oUpkihjCNNWrFSi+CNmaCzA1IuPFGGrJkiWNR+xADeEidwh3dsyaNavxlx2Y7pR6QiOqPNmqyHKzoFZUiTx16lRT+Vig3XRQ9+Q2YCDmgy3CFTLNFbaqnGzRiwWGfu7JbcBAGMoqeLKL3AGW73FOvee7SlSJ7FSDKpGZA7YKi+u0okZkQjULz6zCIjqt6UaVJ7Os1Cp0UBe5Daw3Yg2SReicmm+8V+XJ5DWLIZvVkLTdPbkNGIi8ZtGbP3z44J7cKVTX7ABgDXYsAPfkNmAg8jKr/S3BLBc7FdS5hKcdqjwZoWUfDyu8efMmtlerF4M6kSm88AwrPH78OKYZF7lDMBRh7969e41HdEOhiMiaQzWoEhnIyxRfFnIzAmsP1aBOZAxGMXPr1q3GIzohRN++fTt2She5AIS/ly9fqvbmu3fvxvGxhZ2BVLZQPOPy5csqr0zJfl90Ru1eDGq7IR6Cp1y/fr3xiB4uXbqk+qrTaNSKjAG5pYbczGZyWiAPP3nyxIwXg+qEghHx6AsXLkSvrhs629WrV00JDOqrBkQmNA4NDYWvX782Hs0PM3Hnzp2Lv1sotpox0VrC9ufPn8PJkyfjz9y8fv06nD59OhaB1gQGMy1GaC5DHjt2LBo9Fw8fPgynTp2K14u1z2yNhaluidAYG4/OMVnCEO7s2bNxcsaqwGAu9oixGcacOHGikuvPXCA5evRo7Eh0LIshuhk1+13jLXLI34CBqWRHV7P8X67+sKUDm7Swg24KpIEbN27Efa45r5x7LJrbLO2VtsrrWr2+arBP7ZuaYxgWb4tY7F/J4jHWRPE7oZmh08ePH1uKza03/J91wuw3wnYUneyky2vJ84jKbvVEBd4HW7QTh3ZzsMsAy3tk8zZGAFwu5Sc3+PFeY7W9amoTWXo9wrC0hF33li9fHlfrIwwGGQ3FD/lRjPY3YzV3GN4DoyMAh3Qc/s95EYGOQ6XOwWubxWgFz+UctJ0NVcfa34RhHzcUPHr0KHYizknozyl2dpGbxWWh+dq1a+OGZ51ujIpnME4lX2LgVoaSc3EgrDwGYuTRRyfwHkQX0sL+/fs7XmqLsR88eBDnu4kcufJ8VpExDuLiqVu3bo2bkBaFuWzyJsJ04nllIB2Gz0A62LlzZ2GRKOaGh4djZxHProosImMY8SQKoy1btpTyoV69ehXOnz8fvaKdV6ci4hLu2QZ55cqVjf8Uh9BN+wnjVba/cpHFOIRm9qtmK6Qy4QOQp+VWIdpfprFoP+cAIs/27dtLXyRPRLp27VpsexXhu1KRRWBOwI7zVXoaxc2VK1fiTQZirJTzibj8pKgivVS5BSS2P3PmTDxf2Y5WmcgiMIUVuSsXhD7yNaIjtIjdieC0WdrN6xCXzdRz7dLLxQ+mTjl/mUJXJjJDB7YipPqsA/L1nTt3omdTkTcL3owIiyH47KQVhnJU/HVsUPP+/ftw/Pjx2CbaWwaViMybYqAjR46U1tCiUL1iOO4TY5KDW3YwICA4lS11AqEYj61D2NFw9+e/epRWjJUusngF36HEBIdTDOYCGFMjdCoicmnuhufwxZgucBp8JYPMzpVFKSLTIGauKFacNJgHpy7AC8uiFJFpEA1j+0EnHSIi6VNqiFSSRaYhNIiGOeXARRWKwbJCdrLINIQ8TMOc8pCQXYY3J4ksFXXKBQfn73DplfRXu8hAqa/5+5usgsDso63Ck5lE0DCR0I0sXry4lCo7SWTyMbfcONXAHDozh6ne7CIrhmK2jLxcWGQ5sVfV1UG9w900tXoyk/yd3qPlFIPhaep4OUlkJkHKvlvC+T+kw9pEJoQQTlzkaiEdpk5xJofr1EuUTmsovHCkWkQWT3aqRUROIUlknwTJA3auzZM7WW/kpJM6jEoS2YdPeeAmw5QK28O1AWoJ15yQqpqiwKkeImbKHHZhT0ZkhlBO9VBdp9i6sCdzUh9C5QFbc7gndzE4U3ZPBk7qs115wM4pK1IKvZJy3ivrvNRSePkYOS8pw6hCInMyy19obZHs4RqRfUozLylfp184J7vIdhi3yPQmSnofI+cluydT0rvIeUkZrhb2ZL/tJy9FvRgKe7LPduWFIWu2cM2JELiMPS2czkmZlygkss925SdruOZkPhFii0Ii+xjZFoVE9jtCbDEukRGYgsvDtS36maLkYLFzu4PnIbJPhNTD3zRpdYi2fcPDwyNsOtrpkIirIYODgz4Zkhm2kOQbdMbjYETegYGB8A/hTaV31Q8zwAAAAABJRU5ErkJggg=="},t}();e.SpApi15=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.getCurrentUser=function(o){var i={};t.getListItems("","User Information List",'<ViewFields><FieldRef Name="ID" /><FieldRef Name="Name" /><FieldRef Name="EMail" /><FieldRef Name="Department" /><FieldRef Name="JobTitle" /><FieldRef Name="UserName" /><FieldRef Name="Office" /></ViewFields>','<Query><Where><Eq><FieldRef Name="ID" /><Value Type="Counter"><UserID /></Value></Eq></Where></Query>',function(t,n,a){$(t).find("*").filter(function(){return e.Utils.isZrow(this)}).each(function(e,t){i.id=parseInt($(t).attr("ows_ID")),i.title=$(t).attr("ows_Title"),i.login=$(t).attr("ows_Name"),i.email=$(t).attr("ows_EMail"),i.jobtitle=$(t).attr("ows_JobTitle"),i.department=$(t).attr("ows_Department"),i.account=i.id+";#"+i.title,i.groups=[]}),o(i)})},t.getUsersGroups=function(t,o,i){function n(e,t,i){var n=$(e).find("errorstring");if(n&&""!=n.text())o(null,n.text());else{var a=[];$(e).find("Group").each(function(e,t){a.push({id:parseInt($(t).attr("ID")),name:$(t).attr("Name")})}),o(a)}}void 0===i&&(i="");var a='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetGroupCollectionFromUser xmlns="http://schemas.microsoft.com/sharepoint/soap/directory/"><userLoginName>'+t+"</userLoginName></GetGroupCollectionFromUser></soap:Body></soap:Envelope>",r=$.ajax({url:e.Utils.formatSubsiteUrl(i)+"_vti_bin/usergroup.asmx",type:"POST",dataType:"xml",data:a,contentType:'text/xml; charset="utf-8"'});r.done(n),r.fail(n)},t.getListItems=function(t,o,i,n,a,r){void 0===r&&(r=25),t=e.Utils.formatSubsiteUrl(t),o||e.Utils.logError("Parameter `listName` is null or undefined in method SpSoap.getListItems()",e.SPForm.errorLogListName,e.SPForm.errorLogSiteUrl);var s='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+o+"</listName><query>"+n+"</query><viewFields>"+i+"</viewFields><rowLimit>"+r+"</rowLimit></GetListItems></soap:Body></soap:Envelope>",l=$.ajax({url:t+"_vti_bin/lists.asmx",type:"POST",dataType:"xml",data:s,headers:{SOAPAction:"http://schemas.microsoft.com/sharepoint/soap/GetListItems","Content-Type":"text/xml; charset=utf-8"}});l.done(function(e,t,o){a(e)}),l.fail(function(e,t,o){a(null,t+": "+o)})},t.getList=function(t,o,i){t=e.Utils.formatSubsiteUrl(t);var n='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName></GetList></soap:Body></soap:Envelope>'.replace("{0}",o),a=$.ajax({url:t+"_vti_bin/lists.asmx",type:"POST",cache:!1,dataType:"xml",data:n,headers:{SOAPAction:"http://schemas.microsoft.com/sharepoint/soap/GetList","Content-Type":"text/xml; charset=utf-8"}});a.done(function(e,t,o){i(e)}),a.fail(function(e,t,o){i(null,t+": "+o)})},t.checkInFile=function(e,t,o,i){void 0===i&&(i="");var n=[e,i,t];return this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/CheckInFile",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckInFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>{0}</pageUrl><comment>{1}</comment><CheckinType>{2}</CheckinType></CheckInFile></soap:Body></soap:Envelope>',n,null,o)},t.checkOutFile=function(e,t,o,i){var n=[e,t,o];return this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/CheckOutFile",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>{0}</pageUrl><checkoutToLocal>{1}</checkoutToLocal><lastmodified>{2}</lastmodified></CheckOutFile></soap:Body></soap:Envelope>',n,null,i)},t.executeSoapRequest=function(t,o,i,n,a,r){void 0===n&&(n="/"),void 0===a&&(a=void 0),void 0===r&&(r="lists.asmx"),n=e.Utils.formatSubsiteUrl(n);try{var s=n+"_vti_bin/"+r;if(null!=i)for(var l=0;l<i.length;l++)o=o.replace("{"+l+"}",null==i[l]?"":i[l]);var d=$.ajax({url:s,cache:!1,type:"POST",data:o,headers:{"Content-Type":"text/xml; charset=utf-8",SOAPAction:t}});a&&d.done(a),d.fail(function(t,o,i){var n="Error in SpSoap.executeSoapRequest. "+o+": "+i+" ";e.SPForm.enableErrorLog&&!e.SPForm.DEBUG&&e.Utils.logError(n,e.SPForm.errorLogListName),a&&a(t,o,i)})}catch(t){e.Utils.logError("Error in SpSoap.executeSoapRequest.",JSON.stringify(t),e.SPForm.errorLogListName),console.warn(t)}},t.updateListItem=function(o,i,n,a,r,s){void 0===a&&(a=!0),void 0===r&&(r="/"),void 0===s&&(s=void 0);for(var l=a?"New":"Update",d=[i],c="<Batch OnError='Continue'><Method ID='1' Cmd='"+l+"'>",u=0;u<n.length;u++)c+="<Field Name='"+n[u][0]+"'>"+e.Utils.escapeColumnValue(n[u][1])+"</Field>";"New"!==l&&(c+="<Field Name='ID'>"+o+"</Field>"),c+="</Method></Batch>",d.push(c),t.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName><updates>{1}</updates></UpdateListItems></soap:Body></soap:Envelope>',d,r,s)},t.searchPrincipals=function(e,o,i,n){void 0===i&&(i=10),void 0===n&&(n="User");t.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/SearchPrincipals",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SearchPrincipals xmlns="http://schemas.microsoft.com/sharepoint/soap/"><searchText>{0}</searchText><maxResults>{1}</maxResults><principalType>{2}</principalType></SearchPrincipals></soap:Body></soap:Envelope>',[e,i,n],"/",function(e,t,i){var n=[];$(e).find("PrincipalInfo").each(function(e,t){var o=parseInt($("UserInfoID",t).text());if(o>0){var i=$("AccountName",t).text().replace(/^i\:0\#\.w\|/,"");n.push({AccountName:i,UserInfoID:o,DisplayName:$("DisplayName",t).text(),Email:$("Email",t).text(),Title:$("Title",t).text(),IsResolved:"true"==$("IsResolved",t).text(),PrincipalType:$("PrincipalType",t).text()})}}),o(n)},"People.asmx")},t.addAttachment=function(e,t,o,i,n,a){var r=e.indexOf(",")>-1?e.split(",")[1]:e;this.executeSoapRequest("http://schemas.microsoft.com/sharepoint/soap/AddAttachment",'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><AddAttachment xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>{0}</listName><listItemID>{1}</listItemID><fileName>{2}</fileName><attachment>{3}</attachment></AddAttachment></soap:Body></soap:Envelope>',[o,i,t,r],n,a,"lists.asmx")},t}();e.SpSoap=t}(Shockout||(Shockout={}));!function(e){var t=function(){return function(e,t){this._description=e||null,this._dateOccurred=t||null}}();e.HistoryItem=t;var o=function(){return function(){}}();e.SpItem=o}(Shockout||(Shockout={}));!function(e){var t=function(){function e(){}return e.getFormAction=function(){var t=document.createElement("div");return t.className="form-action no-print",t.innerHTML=e.soFormAction,t},e.buttonDefault="btn btn-sm btn-default no-print",e.calendarIcon='<span class="glyphicon glyphicon-calendar"></span>',e.personIcon='<span class="glyphicon glyphicon-user"></span>',e.resetButton="btn btn-sm btn-default no-print reset",e.timeControlsHtml='<span class="glyphicon glyphicon-calendar"></span>\n            <select class="form-control so-select-hours" style="margin-left:1em; max-width:5em; display:inline-block;">{0}</select><span> : </span>\n            <select class="form-control so-select-minutes" style="width:5em; display:inline-block;">{1}</select>\n            <select class="form-control so-select-tt" style="margin-left:1em; max-width:5em; display:inline-block;"><option value="AM">AM</option><option value="PM">PM</option></select>\n            <button class="btn btn-sm btn-default reset" style="margin-left:1em;">Reset</button>\n            <span class="error no-print" style="display:none;">Invalid Date-time</span>\n            <span class="so-datetime-display no-print" style="margin-left:1em;"></span>',e.getTimeControlsHtml=function(){for(var t=[],o=1;o<=12;o++)t.push('<option value="'+o+'">'+(o<10?"0"+o:o)+"</option>");for(var i=[],o=0;o<60;o++)i.push('<option value="'+o+'">'+(o<10?"0"+o:o)+"</option>");return e.timeControlsHtml.replace("{0}",t.join("")).replace("{1}",i.join(""))},e.soFormAction='<div class="row">\n            <div class="col-sm-8 col-sm-offset-4 text-right">\n                <label>Logged in as:</label><span data-bind="text: currentUser().title" class="current-user"></span>\n                <button class="btn btn-default cancel" data-bind="event: { click: cancel }" title="Close"><span class="glyphicon glyphicon-remove"></span><span class="hidden-xs">Close</span></button>\n                \x3c!-- ko if: allowPrint() --\x3e\n                    <button class="btn btn-primary print" data-bind="event: {click: print}" title="Print"><span class="glyphicon glyphicon-print"></span><span class="hidden-xs">Print</span></button>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko if: allowDelete() && Id() != null --\x3e\n                    <button class="btn btn-warning delete" data-bind="event: {click: deleteItem}" title="Delete"><span class="glyphicon glyphicon-remove"></span><span class="hidden-xs">Delete</span></button>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko if: allowSave() --\x3e\n                    <button class="btn btn-success save" data-bind="event: { click: save }" title="Save your work."><span class="glyphicon glyphicon-floppy-disk"></span><span class="hidden-xs">Save</span></button>\n                \x3c!-- /ko --\x3e\n                <button class="btn btn-danger submit" data-bind="event: { click: submit }" title="Submit for routing."><span class="glyphicon glyphicon-floppy-open"></span><span class="hidden-xs">Submit</span></button>\n            </div>\n        </div>',e.hasErrorCssDiv="<div class=\"form-group\" data-bind=\"css: {'has-error': !!!modelValue() && !!required(), 'has-success has-feedback': !!modelValue() && !!required()}\">",e.requiredFeedbackSpan='<span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>',e.soNavMenuControl='<so-nav-menu params="val: navMenuItems"></so-nav-menu>',e.soNavMenu='<nav class="navbar navbar-default no-print" id="TOP">\n            <div class="navbar-header">\n                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">\n                <span class="sr-only">Toggle navigation</span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                </button>\n            </div>\n            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n                <ul class="nav navbar-nav" data-bind="foreach: navMenuItems">\n                    <li><a href="#" data-bind="html: title, attr: {\'href\': \'#\' + anchorName }"></a></li>\n                </ul>\n            </div>\n        </nav>',e.soStaticField='<div class="form-group">\n            <div class="row">\n                \x3c!-- ko if: !!label --\x3e\n                    <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label"></label></div>\n                \x3c!-- /ko --\x3e\n                <div class="col-sm-9" data-bind="text: modelValue, attr:{\'class\': fieldColWidth}"></div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n            <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',e.soTextField=e.hasErrorCssDiv+'\n        <div class="row">\n\t        \x3c!-- ko if: !!label --\x3e\n\t\t        <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n\t        \x3c!-- /ko --\x3e\n\t        <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n\t\t        \x3c!-- ko if: readOnly() --\x3e\n\t\t\t        <div data-bind="text: modelValue"></div>\n\t\t        \x3c!-- /ko --\x3e\n\t\t        \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t        \x3c!-- ko if: multiline --\x3e\n\t\t\t\t        <textarea data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, placeholder: placeholder, title: title, required: required, \'ko-name\': koName }" class="form-control"></textarea>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko ifnot: multiline --\x3e\n\t\t\t\t        <input type="text" data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, placeholder: placeholder, title: title, required: required, maxlength: maxlength, \'ko-name\': koName }" class="form-control" />\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko if: !!required() --\x3e\n\t\t\t\t        '+e.requiredFeedbackSpan+'\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        \x3c!-- /ko --\x3e\n\t        </div>\n\t        \x3c!-- ko if: description --\x3e\n\t\t    <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t        \x3c!-- /ko --\x3e\n        </div>',e.soAttachments='<section class="nav-section">\n            <h4><span data-bind="text: title"></span> &ndash; <span data-bind="text: length" class="badge"></span></h4>\n            <div data-bind="visible: !!errorMsg()" class="alert alert-danger alert-dismissable">\n                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <span class="glyphicon glyphicon-exclamation-sign"></span>&nbsp;<span data-bind="text: errorMsg"></span>\n            </div>\n            \x3c!-- ko ifnot: hasFileReader() --\x3e\n            <div data-bind="visible: !!!readOnly(), attr: {id: this.qqFileUploaderId}"></div>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !readOnly() && hasFileReader() --\x3e\n                <div class="row">\n                    <div class="col-md-2 so-attach-files-btn">\n                        <input type="file" data-bind="attr: {\'id\': id}, event: {\'change\': fileHandler}" multiple class="form-control" style="display:none;" />\n                        <div data-bind="attr:{\'class\': className}, event: {\'click\': onSelect}"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;<span data-bind="text: label"></span></div>\n                    </div>\n                    <div class="col-md-10">\n                        \x3c!-- ko if: drop --\x3e\n                            <div class="so-file-dropzone" data-bind="event: {\'dragenter\': onDragenter, \'dragover\': onDragover, \'drop\': onDrop}">\n                                <div><span data-bind="text: dropLabel"></span> <span class="glyphicon glyphicon-upload"></span></div>\n                            </div>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                </div>\n                \x3c!-- ko foreach: fileUploads --\x3e\n                    <div class="progress">\n                        <div data-bind="attr: {\'aria-valuenow\': progress(), \'style\': \'width:\' + progress() + \'%;\', \'class\': className() }" role="progressbar" aria-valuemin="0" aria-valuemax="100">\n                            <span data-bind="text: fileName"></span>\n                        </div>\n                    </div>\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n            <div data-bind="foreach: attachments" style="margin:1em auto;">\n                <div class="so-attachment">\n                    <a href="" data-bind="attr: {href: ServerRelativeUrl}"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;<span data-bind="text: FileName"></span></a>\n                    \x3c!-- ko ifnot: $parent.readOnly() --\x3e\n                    <button data-bind="event: {click: $parent.deleteAttachment}" class="btn btn-sm btn-danger delete" title="Delete Attachment"><span class="glyphicon glyphicon-remove"></span></button>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: length() == 0 && readOnly() --\x3e\n                <p>No attachments have been included.</p>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: description --\x3e\n                <div data-bind="text: description"></div>\n            \x3c!-- /ko --\x3e\n        </section>',e.soHtmlFieldTemplate=e.hasErrorCssDiv+'\n        <div class="row">\n            \x3c!-- ko if: !!label --\x3e\n                <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                \x3c!-- ko if: readOnly() --\x3e\n                    <div data-bind="html: modelValue"></div>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko ifnot: readOnly() --\x3e\n                    <div data-bind="spHtmlEditor: modelValue" contenteditable="true" class="form-control content-editable"></div>\n                    <textarea data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, required: required, \'ko-name\': koName }" data-sp-html="" style="display:none;"></textarea>\n                    \x3c!-- ko if: !!required() --\x3e\n                        '+e.requiredFeedbackSpan+'\n                    \x3c!-- /ko --\x3e\n                \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',e.soCheckboxField='<div class="form-group">\n            <div class="row">\n                <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                    <label data-bind="html: label, attr: {for: id}"></label>\n                    \x3c!-- /ko --\x3e\n                </div>\n                <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                        <div data-bind="text: !!modelValue() ? \'Yes\' : \'No\'"></div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: readOnly() --\x3e\n                        <label class="checkbox">\n                            <input type="checkbox" data-bind="checked: modelValue, css: {\'so-editable\': editable}, attr: {id: id, \'ko-name\': koName}, valueUpdate: valueUpdate" />\n                            <span data-bind="html: label" style="margin-left:1em;"></span>\n                        </label>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',e.soSelectField=e.hasErrorCssDiv+'<div class="row">\n                \x3c!-- ko if: !!label --\x3e\n                    <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label, attr: {for: id}"></label></div>\n                \x3c!-- /ko --\x3e\n                <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n                    \x3c!-- ko if: readOnly() --\x3e\n                        <div data-bind="text: modelValue"></div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: readOnly() --\x3e\n                        <select data-bind="value: modelValue, options: options, optionsCaption: caption, css: {\'so-editable\': editable}, attr: {id: id, title: title, required: required, \'ko-name\': koName}" class="form-control"></select>\n                        \x3c!-- ko if: !!required() --\x3e\n                            '+e.requiredFeedbackSpan+'\n                        \x3c!-- /ko --\x3e\n                    \x3c!-- /ko --\x3e\n                </div>\n            </div>\n            \x3c!-- ko if: description --\x3e\n                <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n        </div>',e.soCheckboxGroup='<div class="form-group">\n            \x3c!-- ko if: description --\x3e\n\t            <div class="so-field-description"><p data-bind="html: description"></p></div>\n            \x3c!-- /ko --\x3e\n            <div class="row">\n\t            \x3c!-- ko if: !!label --\x3e\n\t\t            <div><label data-bind="html: label"></label></div>\n\t            \x3c!-- /ko --\x3e\n\t            <div>\n\t\t            \x3c!-- ko if: readOnly() --\x3e\n\t\t\t            \x3c!-- ko ifnot: inline --\x3e\n\t\t\t\t            <ul class="list-group">\n\t\t\t\t\t            \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t\t\t            <li data-bind="text: $data" class="list-group-item"></li>\n\t\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t\t            \x3c!-- ko if: modelValue().length == 0 --\x3e\n\t\t\t\t\t\t            <li class="list-group-item">--None--</li>\n\t\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t            </ul>\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t            \x3c!-- ko if: inline --\x3e\n\t\t\t\t            \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t\t            <span data-bind="text: $data"></span>\n\t\t\t\t\t            \x3c!-- ko if: $index() < $parent.modelValue().length-1 --\x3e,&nbsp;\x3c!-- /ko --\x3e\n\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t\t            \x3c!-- ko if: modelValue().length == 0 --\x3e\n\t\t\t\t\t            <span>--None--</span>\n\t\t\t\t            \x3c!-- /ko --\x3e\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t            <input type="hidden" data-bind="value: modelValue, attr:{required: !!required}" /><p data-bind="visible: !!required" class="req">(Required)</p>\n\t\t\t            \x3c!-- ko foreach: options --\x3e\n\t\t\t\t            <label data-bind="css:{\'checkbox\': !$parent.inline, \'checkbox-inline\': $parent.inline}">\n\t\t\t\t\t            <input type="checkbox" data-bind="checked: $parent.modelValue, css: {\'so-editable\': $parent.editable}, attr: {\'ko-name\': $parent.koName, \'value\': $data}" />\n\t\t\t\t\t            <span data-bind="text: $data"></span>\n\t\t\t\t            </label>\n\t\t\t            \x3c!-- /ko --\x3e\n\t\t            \x3c!-- /ko --\x3e\n\t            </div>\n            </div>',e.soRadioGroup='<div class="form-group">\n\t        \x3c!-- ko if: description --\x3e\n\t\t        <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t        \x3c!-- /ko --\x3e\n\t        <div class="row">\n\t\t        \x3c!-- ko if: !!label --\x3e\n\t\t\t        <div class="col-sm-3" data-bind="attr:{\'class\': labelColWidth}"><label data-bind="html: label"></label></div>\n\t\t        \x3c!-- /ko --\x3e\n\t\t        <div class="col-sm-9" data-bind="attr:{\'class\': fieldColWidth}">\n\t\t\t        \x3c!-- ko if: readOnly() --\x3e\n\t\t\t\t        <div data-bind="text: modelValue"></div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko ifnot: readOnly() --\x3e\n\t\t\t\t        \x3c!-- ko foreach: options --\x3e\n\t\t\t\t\t        <label data-bind="css:{\'radio\': !$parent.inline, \'radio-inline\': $parent.inline}">\n\t\t\t\t\t\t        <input type="radio" data-bind="checked: $parent.modelValue, attr:{value: $data, name: $parent.name, \'ko-name\': $parent.koName}, css:{\'so-editable\': $parent.editable}" />\n\t\t\t\t\t\t        <span data-bind="text: $data"></span>\n\t\t\t\t\t        </label>\n\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        </div>\n\t        </div>\n        </div>',e.soUsermultiField='<div class="form-group">\n\t        <input type="hidden" data-bind="value: modelValue, css: {\'so-editable\': editable}, attr: {id: id, \'ko-name\': koName, required: required}" />\n\t        <div class="row">\n\t\t        <div class="col-md-3 col-xs-3">\n\t\t\t        <label data-bind="html: label"></label>\n\t\t        </div>\n\t\t        <div class="col-md-9 col-xs-9">\n\t\t\t        \x3c!-- ko ifnot: readOnly --\x3e\n\t\t\t\t        <input type="text" data-bind="spPerson: person, attr: {placeholder: placeholder}" />\n\t\t\t\t        <button class="btn btn-success" data-bind="click: addPerson, attr: {\'disabled\': person() == null, id: koName + \'_AddButton\' }"><span>Add</span></button>\n\t\t\t\t        \x3c!-- ko if: showRequiredText --\x3e\n\t\t\t\t\t        <div class="col-md-6 col-xs-6">\n\t\t\t\t\t\t        <p class="text-danger">At least one person must be added.</p>\n\t\t\t\t\t        </div>\n\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko foreach: modelValue --\x3e\n\t\t\t\t        <div class="row">\n\t\t\t\t\t        <div class="col-md-10 col-xs-10" data-bind="spPerson: $data"></div>\n\t\t\t\t\t        \x3c!-- ko ifnot: $parent.readOnly() --\x3e\n\t\t\t\t\t\t        <div class="col-md-2 col-xs-2">\n\t\t\t\t\t\t\t        <button class="btn btn-xs btn-danger" data-bind="click: $parent.removePerson"><span class="glyphicon glyphicon-trash"></span></button>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t\t        </div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t\t        \x3c!-- ko if: description --\x3e\n\t\t\t\t        <div class="so-field-description"><p data-bind="html: description"></p></div>\n\t\t\t        \x3c!-- /ko --\x3e\n\t\t        </div>\n\t        </div>\n        </div>',e.soWorkflowHistoryControl='\x3c!-- ko if: !!Id() && historyItems().length > 0 --\x3e\n            <section id="workflowHistory" class="nav-section">\n                <h4>Workflow History</h4>\n                <so-workflow-history params="val: historyItems"></so-workflow-history>\n            </section>\n        \x3c!-- /ko --\x3e',e.soWorkflowHistory='<div class="row">\n            <div class="col-sm-8"><strong>Description</strong></div>\n            <div class="col-sm-4"><strong>Date</strong></div>\n        </div>\n        \x3c!-- ko foreach: historyItems --\x3e\n            <div class="row">\n                <div class="col-sm-8"><span data-bind="text: _description"></span></div>\n                <div class="col-sm-4"><span data-bind="spDateTime: _dateOccurred"></span></div>\n            </div>\n        \x3c!-- /ko --\x3e',e.soCreatedModifiedInfoControl='\x3c!-- ko if: !!CreatedBy && CreatedBy() != null --\x3e\n            <section class="nav-section">\n                <h4>Created/Modified By</h4>\n                <so-created-modified-info params="created: Created, createdBy: CreatedBy, modified: Modified, modifiedBy: ModifiedBy, showUserProfiles: showUserProfiles"></so-created-modified-info>\n            </section>\n        \x3c!-- /ko --\x3e',e.soCreatedModifiedInfo='\x3c!-- ko if: showUserProfiles() --\x3e\n            <div class="create-mod-info no-print hidden-xs">\n                \x3c!-- ko foreach: profiles --\x3e\n                    <div class="user-profile-card">\n                        <h4 data-bind="text: header"></h4>\n                        \x3c!-- ko with: profile --\x3e\n                            <img data-bind="attr: {src: Picture, alt: Name}" style="width:90px;" />\n                            <ul>\n                                <li><label>Name</label><span data-bind="text: Name"></span><li>\n                                <li><label>Job Title</label><span data-bind="text: Title"></span></li>\n                                <li><label>Department</label><span data-bind="text: Department"></span></li>\n                                <li><label>Email</label><a data-bind="text: WorkEmail, attr: {href: (\'mailto:\' + WorkEmail)}"></a></li>\n                                <li><label>Phone</label><span data-bind="text: WorkPhone"></span></li>\n                                <li><label>Office</label><span data-bind="text: Office"></span></li>\n                            </ul>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                \x3c!-- /ko --\x3e\n            </div>\n        \x3c!-- /ko --\x3e\n        <div class="row">\n            \x3c!-- ko with: CreatedBy --\x3e\n                <div class="col-md-3"><label>Created By</label> <a data-bind="text: Name, attr: {href: \'mailto:\' + WorkEmail}" class="email"> </a></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-md-3"><label>Created</label> <span data-bind="spDateTime: Created"></span></div>\n            \x3c!-- ko with: ModifiedBy --\x3e\n                <div class="col-md-3"><label>Modified By</label> <a data-bind="text: Name, attr: {href: \'mailto:\' + WorkEmail}" class="email"></a></div>\n            \x3c!-- /ko --\x3e\n            <div class="col-md-3"><label>Modified</label> <span data-bind="spDateTime: Modified"></span></div>\n        </div>',e}();e.Templates=t}(Shockout||(Shockout={}));!function(e){var t=function(){function t(){}return t.tail=function(e){if(null==e||void 0==e)return e;if(e.constructor!==Array)return e;var t=e.length;return t>0?e[t-1]:void 0},t.indexOf=function(e,t){if(Array.prototype.indexOf)return Array.prototype.indexOf.apply(e,[t]);for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1},t.formatSubsiteUrl=function(e){return e?/\/$/.test(e)?e:e+"/":"/"},t.toCamelCase=function(e){return e.toString().replace(/\s*\b\w/g,function(e){return(e[1]||e[0]).toUpperCase()}).replace(/\s/g,"").replace(/\'s/,"S").replace(/[^A-Za-z0-9\s_]/g,"")},t.getIdFromHash=function(){var e=window.location!=window.parent.location?document.referrer:document.location.href,t=/#\/id\/\d+/i.exec(e),o=t?t[0].replace(/\D/g,""):null;return/\d/.test(o)?parseInt(o):null},t.setIdHash=function(e){window.location.hash="#/id/"+e},t.escapeColumnValue=function(e){return"string"==typeof e?e.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):e},t.getParent=function(e,t){void 0===t&&(t=1);for(var o=0;o<t;o++)e&&(e=e.parentNode);return e},t.getPrevKOComment=function(e){do{e=e.previousSibling}while(e&&8!=e.nodeType&&!/^\s*ko/.test(e.textContent));return e},t.getKoComments=function(e){var t=[];return e=e||$("body"),$(e).contents().filter(function(e,t){return 8==t.nodeType&&/^\s*ko/.test(t.nodeValue)}).each(function(e,o){t.push(o.nodeValue.replace(/\s*ko\s*foreach\s*:\s*(\$root\.|)/,"").replace(/\s/g,""))}),t},t.getKoContainerlessControls=function(e){var t=[];return e=e||document.body,$(e).contents().filter(function(e,t){return 8==t.nodeType&&/^\s*ko\s*foreach:/.test(t.nodeValue)}).each(function(e,o){t.push(o)}),t},t.getEditableKoContainerlessControls=function(e){e=e||document.body;for(var o=t.getKoContainerlessControls(e),i=[],n=/(^button|submit|cancel|reset)/i,a=/(input|textarea)/i,r=/\$data/,s=0;s<o.length;s++){var l=t.getNextSibling(o[s]),d=l.getAttribute("data-bind");if(d&&a.test(l.tagName)&&r.test(d)&&n.test(l.getAttribute("type")))i.push(o[s]);else{l.querySelectorAll("input[data-bind*='$data']:enabled, textarea[data-bind*='$data']:enabled").length>0&&i.push(o[s])}}return i},t.getEditableKoControlNames=function(e){function t(e,t){var i=n.exec($(t).attr("data-bind")),a=i?i[0].replace(/:(\s+|)/g,"").replace(/\$root\./,"").replace(/\s/g,""):null;null!=a&&o.push(a)}var o=[],i=/(button|submit|cancel|reset)/,n=/\s*:\s*(\$root.|)\w*\b/;$(e).find("[data-bind]").filter(":input").filter(function(e,t){return!i.test($(t).attr("type"))}).each(t);return $(e).find('[data-bind][contenteditable="true"]').each(t),o},t.getEditableKoNames=function(e){e=e||document.body;var o=[];$(e).find(".so-editable[ko-name]").each(function(e,i){var n=$(i).attr("ko-name");t.indexOf(o,n)<0&&o.push(n)});for(var i=t.getEditableKoContainerlessControls(e),n=0;n<i.length;n++){r=i[n].nodeValue.replace(/\s*ko\s*foreach\s*:\s*(\$root\.|)/,"").replace(/\s/g,"");t.indexOf(o,r)<0&&o.push(r)}for(var a=t.getEditableKoControlNames(e),n=0;n<a.length;n++){var r=a[n];t.indexOf(o,r)<0&&o.push(r)}return o},t.getNextSibling=function(e){do{e=e.nextSibling}while(1!=e.nodeType);return e},t.observableNameFromControl=function(e,t){void 0===t&&(t=void 0);var o=e.getAttribute("data-bind");if(!o)return null;var i=$(e).attr("ko-name");if(i)return i;var n=/(\b:\s*|\$root\.)\w*\b/.exec(o);return i=n?n[0].replace(/:(\s+|)/g,"").replace(/\$root\./,"").replace(/\s/g,""):null},t.parseJsonDate=function(e){return t.isJsonDateTicks(e)?new Date(parseInt(e.replace(/\D/g,""))):null},t.parseIsoDate=function(e){return t.isIsoDateString(e)?new Date(e):null},t.isJsonDateTicks=function(e){return!!e&&/\/Date\(\d+\)\//.test(e+"")},t.isIsoDateString=function(e){return!!e&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/.test(e+"")},t.getQueryParam=function(e){var t="",o=window.location!=window.parent.location?document.referrer:document.location.href;o.indexOf("?")>-1&&(t="?"+o.split("?")[1]);e=(0,window.escape)((0,window.unescape)(e));var i=new RegExp("[?&]"+e+"(?:=([^&]*))?","i").exec(t);return null!=i?i[1]:null},t.clone=function(e){if(!(e instanceof Object))return e;var o,i=e.constructor;switch(i){case RegExp:o=new i(e);break;case Date:o=new i(e.getTime());break;default:o=new i}for(var n in e)o[n]=t.clone(e[n]);return o},t.logError=function(o,i,n,a){if(void 0===n&&(n="/"),void 0===a&&(a=!1),a||!e.SPForm.enableErrorLog)throw o;n=t.formatSubsiteUrl(n);var r=window.location.href,s='<p>An error occurred at <a href="'+r+'" target="_blank">'+r+"</a></p><p>Message: "+o+"</p>";$.ajax({url:n+"_vti_bin/listdata.svc/"+i.replace(/\s/g,""),type:"POST",processData:!1,contentType:"application/json;odata=verbose",data:JSON.stringify({Title:"Web Form Error",Error:s}),headers:{Accept:"application/json;odata=verbose"}}).fail(function(e){throw e.responseJSON.error})},t.updateKoField=function(e,t){"input"==e.tagName.toLowerCase()?$(e).val(t):$(e).html(t)},t.validateSpPerson=function(e){return null!=e&&null!=e.toString().match(/^\d*;#/)},t.isTime=function(e){if(!e)return!1;return/\d{1,2}:\d{2}(:\d{2}|)\s{0,1}(AM|PM)/.test(e)},t.isDate=function(e){if(!e)return!1;return/\d{1,2}\/\d{1,2}\/\d{4}/.test(e.toString())},t.dateToLocaleString=function(e){try{var t=e.getUTCDate();t=t<10?"0"+t:t;var o=e.getUTCMonth()+1;return(o=o<10?"0"+o:o)+"/"+t+"/"+e.getUTCFullYear()}catch(e){return"Invalid Date"}},t.toTimeLocaleObject=function(e){var t,o,i=0;return i=e.getUTCHours(),t=e.getUTCMinutes(),o=i>11?"PM":"AM",t<10&&(t="0"+t),i>12&&(i-=12),{hours:i,minutes:t,tt:o}},t.toTimeLocaleString=function(e){var t=e.getUTCHours(),o=e.getUTCMinutes(),i=t>11?"PM":"AM";return o<10&&(o="0"+o),t>12?t-=12:0==t&&(t=12),t+":"+o+" "+i},t.toDateTimeLocaleString=function(e){var o=t.toTimeLocaleString(e);return t.dateToLocaleString(e)+" "+o},t.parseDate=function(e){if(!e)return null;if("object"==typeof e&&e.constructor==Date)return e;var t,o,i,n,a=/\d{1,2}\/\d{1,2}\/\d{2,4}/,r=/\d{4}-\d{1,2}-\d{1,2}/,s=null;return""==(e=r.test(e)?e:(e+"").replace(/[^0-9\/\-]/g,""))?null:(a.test(e)||/\d{1,2}-\d{1,2}-\d{2,4}/.test(e)?(t=a.test(e)?e.split("/"):e.split("-"),o=parseInt(t[0])-1,i=parseInt(t[1]),n=(n=parseInt(t[2]))<100?2e3+n:n,s=new Date(n,o,i,0,0,0,0)):r.test(e)?(t=e.split("-"),n=parseInt(t[0]),o=parseInt(t[1])-1,i=parseInt(t[2]),n=n<100?2e3+n:n,s=new Date(n,o,i,0,0,0,0)):/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/.test(e)?s=new Date(e):/(\/|)\d{13}(\/|)/.test(e)&&(s=new Date(parseInt(e.replace(/\D/g,"")))),s)},t.formatMoney=function(e,o,i){void 0===o&&(o="$"),void 0===i&&(i=2);var n=t.unformatNumber(e),a="%s%v".replace("%v","-%v"),r=n>0?"%s%v":n<0?a:"%s%v",s=t.formatNumber(Math.abs(n),t.checkPrecision(i));return r.replace("%s",o).replace("%v",s)},t.unformatNumber=function(e){if("number"==typeof e)return e;var t=parseFloat((e+"").replace(/\((.*)\)/,"-$1").replace(/[^0-9-.]/g,""));return isNaN(t)?0:t},t.formatNumber=function(e,o){void 0===o&&(o=0);var i=t.unformatNumber(e),n=t.checkPrecision(o),a=i<0?"-":"",r=parseInt(t.toFixed(Math.abs(i||0),n),10)+"",s=r.length>3?r.length%3:0;return a+(s?r.substr(0,s)+",":"")+r.substr(s).replace(/(\d{3})(?=\d)/g,"$1,")+(n?"."+t.toFixed(Math.abs(i),n).split(".")[1]:"")},t.isString=function(e){return!!(""===e||e&&e.charCodeAt&&e.substr)},t.toFixed=function(e,o){void 0===o&&(o=0),o=t.checkPrecision(o);var i=Math.pow(10,o);return(Math.round(t.unformatNumber(e)*i)/i).toFixed(o)},t.checkPrecision=function(e){return e=Math.round(Math.abs(e)),isNaN(e)?0:e},t.compareArrays=function(e,o){for(var i=[],n=0;n<e.length;n++)for(var a=0;a<o.length;a++)e[n]==o[a]&&t.indexOf(i,o[a])<0&&i.push(o[a]);return i},t.trim=function(e){return t.isString(e)?e.replace(/(^\s+|\s+$)/g,""):e},t.formatPictureUrl=function(e){return null==e?"/_layouts/images/person.gif":e.indexOf(",")>-1?e.split(",")[0]:e},t.isZrow=function(e){return"z:row"==e.nodeName.toLowerCase()},t.koNameFromControl=t.observableNameFromControl,t}();e.Utils=t}(Shockout||(Shockout={}));!function(e){var t=function(){return function(t,o,i,n,a,r){var s=t+(o=e.Utils.formatSubsiteUrl(o))+"_api/Web/Lists(guid'"+i+"')/Items("+a+")/AttachmentFiles('"+r+"')";this.__metadata={uri:s,id:s,type:"SP.Attachment"},this.FileName=r,this.ServerRelativeUrl="/"+o+"Lists/"+n+"/Attachments/"+a+"/"+r}}();e.SpAttachment=t;var o=function(){function e(e){return void 0===e&&(e=void 0),e&&(this.asyncFns=e),this}return e.prototype.start=function(e){void 0===e&&(e=void 0),this.next(!0,e)},e.prototype.complete=function(e){return this._complete=e,this},e.prototype.fail=function(e){return this._fail=e,this},e.prototype.finally=function(e){return this._finally=e,this},e.prototype.next=function(e,t,o){if(void 0===e&&(e=!0),void 0===t&&(t=void 0),void 0===o&&(o=void 0),!this.asyncFns)throw"Error in Cafe: The required parameter `asyncFns` of type (Array<Function>) is undefined. Don't forget to instantiate Cafe with this parameter or set its value after instantiation.";this._complete&&this._complete(t,e,o),e?0!=this.asyncFns.length?this.asyncFns.shift()(this,o):this._finally&&this._finally(t,e,o):this._fail&&this._fail(t,e,o)},e}();e.Cafe=o;var i=function(){return function(e,t){var o=this;this.label=ko.observable(null),this.progress=ko.observable(0),this.fileName=ko.observable(e),this.kb=ko.observable(t/1024),this.className=ko.observable("progress-bar progress-bar-info progress-bar-striped active"),this.getProgress=ko.pureComputed(function(){return o.fileName()+" "+o.progress()+"%"},this)}}();e.FileUpload=i;var n=function(){function t(t,o){function i(){n.setModelValue(o)}var n=this,a=ko.unwrap(o);this.$element=$(t),this.$parent=this.$element.parent(),e.Utils.isJsonDateTicks(a)&&o(e.Utils.parseJsonDate(a)),this.required=this.$element.hasClass("required")||null!=this.$element.attr("required"),this.$element.attr({placeholder:"MM/DD/YYYY",maxlength:10,class:"datepicker med form-control"}).css("display","inline-block").on("change",i).datepicker({changeMonth:!0,changeYear:!0}),this.required&&this.$element.attr("required",""),this.$element.after(e.Templates.getTimeControlsHtml()),this.$display=this.$parent.find(".so-datetime-display"),this.$error=this.$parent.find(".error"),this.$hh=this.$parent.find(".so-select-hours").val("12").on("change",i),this.$mm=this.$parent.find(".so-select-minutes").val("0").on("change",i),this.$tt=this.$parent.find(".so-select-tt").val("AM").on("change",i),this.$reset=this.$parent.find(".btn.reset").on("click",function(){try{n.$element.val(""),n.$hh.val("12"),n.$mm.val("0"),n.$tt.val("AM"),n.$display.html(""),o(null)}catch(e){console.warn(e)}return!1})}return t.prototype.setModelValue=function(t){try{var o=this.$element.val();if(!$.trim(this.$element.val()))return;var i=parseInt(this.$hh.val()),n=parseInt(this.$mm.val()),a=this.$tt.val();"PM"==a&&i<12?i+=12:"AM"==a&&i>11&&(i-=12);var r=new Date(o);r.setUTCHours(i,n,0,0),t(r)}catch(t){if(e.SPForm.DEBUG)throw t}},t.prototype.setDisplayValue=function(t){try{o=ko.unwrap(t);if(!o||o.constructor!=Date)return;var o,i=(o=ko.unwrap(t)).getUTCHours(),n=o.getUTCMinutes();this.$element.val(o.getUTCMonth()+1+"/"+o.getUTCDate()+"/"+o.getUTCFullYear()),i>12?(i-=12,this.$tt.val("PM")):0==i?(i=12,this.$tt.val("AM")):12==i?this.$tt.val("PM"):this.$tt.val("AM"),this.$hh.val(i.toString()),this.$mm.val(n.toString()),this.$display.html(this.toString(t))}catch(t){if(e.SPForm.DEBUG)throw t}},t.prototype.toString=function(e){return t.toString(e)},t.toString=function(t){try{var o=ko.unwrap(t);if(null==o||o.constructor!=Date)return;var i=e.Utils.toDateTimeLocaleString(o),n=/\b\s\(\w+\s\w+\s\w+\)/i.exec(o.toString());return n&&(i+=" "+n[0].replace(/\b\w+/g,function(e){return e[0]}).replace(/\s/g,"")),i}catch(t){if(e.SPForm.DEBUG)throw t}return null},t}();e.DateTimeModel=n}(Shockout||(Shockout={}));var Shockout;!function(e){var t=function(){return function(){}}();e.ClassNameDict=t}(Shockout||(Shockout={}));